<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta http-equiv="Cache-control" content="no-cache">
<title>一路上直播</title>
<meta name="MobileOptimized" content="320">

<!--ios-->
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta content="telephone=no" name="format-detection">
<base href="http://www.pt163.com/">
<meta http-equiv="Page-Enter" contect="revealTrans(duration=10,transtion= 50)">
<meta http-equiv="Page-Exit" contect="revealTrans(duration=20,transtion=6)">
<link rel="stylesheet" href="{$_W['siteroot']}addons/siyuan_cms/js/css.css">
<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
<script src="{$_W['siteroot']}addons/siyuan_cms/js/swipe3.js"></script>
<script src="{$_W['siteroot']}addons/siyuan_cms/js/iscroll.js"></script>
{php echo register_jssdk(false);}
</head>
<body>

<div class="video" style="height: 432px;">
    <iframe frameborder="0" width="100%" height="100%" src="http://yuntv.letv.com/bcloud.html?uu=8ywrpfgto8&amp;vu=c8ea0f1ba5&amp;auto_play=1&amp;gpcflag=1&amp;width=100%&amp;height=100%" allowfullscreen="false"></iframe>
<div class="video-views"><i class="fa fa-users"></i> 4056</div>
</div>

<script>
    var c_height = Math.round($(window).width() * 9 / 16);
    $(".video").height(c_height);
</script>

<div class="view">
    <div class="content_tab">
        <ul>
            <li id="w_chat" class="cur">
                <a>
                    录播聊天<em id="comment_num">44</em>
                </a>
            </li>
            <li id="i_live">
                <a>直播介绍</a>
            </li>
            <li id="l_gift">
                <a>礼物排行</a>
            </li>
        </ul>
        <div class="guanzhu action" data-type="subscribe">
            <p>订阅</p>
            <p class="gznum" id="guanzhu_num">33</p>
        </div>
    </div>

    <!--直播聊天-->
    <div class="wrapper_c" style="height: 486px;">
        <div id="wrapper" class="wrapper" style="height: 486px; overflow: hidden;">
            <div id="scroller" class="scroller" style="transition-property: transform; transform-origin: 0px 0px 0px; transition-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1); transform: translate(0px, -41px) scale(1) translateZ(0px); transition-duration: 400ms;">

                <div id="pullDown" class="">
                    <span class="pullDownIcon"></span>
                    <span class="pullDownLabel"></span>
                </div>

                <div class="content_box" id="wrap">
                    <div class="content clear" id="comments"><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/51/54/19_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">七彩童年儿童摄：</span>33</p></ul></div><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/30/70/74_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">小陈陈：</span>壮哉我大平潭</p></ul></div><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/04/87/38_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">wx_xyz_i6uJj：</span>无啦啦</p></ul></div><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/24/06/48_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">wx_khin_mmIkG：</span>测试一下</p></ul></div><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/24/06/48_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">wx_khin_mmIkG：</span>为啥两条信息</p></ul></div><div class="tall"><ul class="LImg"><img src="http://user.163core.com/data/avatar/000/19/01/89_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"></ul><ul class="tall_b"><p><span class="name">wx_Sunshi_RfA65：</span>。在。。。</p></ul></div></div>
                </div>
            </div>

        </div>


        <!--直播介绍-->
        <div id="wrapper1" class="wrapper" style="height: 486px; overflow: hidden;">
            <div id="scroller1" class="scroller" style="transition-property: transform; transform-origin: 0px 0px 0px; transition-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1); transform: translate(0px, 0px) translateZ(0px);">
                <div class="top">
                    <dt>
                        <img src="http://user.163core.com/data/avatar/000/00/00/01_avatar_small.jpg" onerror="this.onerror=null;this.src='http://user.163core.com/images/noavatar_small.gif'"> <em></em>
                    </dt>
                    <dl>

                        <ul>
                            <li class="top_live"> <i></i>
                                <span>
                                                                            录播
                                                                    </span>
                            </li>
                        
                            <li class="top_time"></li>
                            
                        </ul>
                        
                        <ul>
                            <li class="top_people"> <i></i>
                                <span class="top_text">4056</span>
                            </li>
                            <li class="top_gift">
                                <i></i>
                                <span class="top_text">2</span>
                            </li>
                        </ul>
                    </dl>

                </div>
                <div class="channel_desc">2016“海洋杯"中国·平潭国际自行车公开赛</div>
            </div>

        </div>

        <!--礼物排行-->
        <div id="wrapper2" class="wrapper" style="height: 486px; overflow: hidden;">
            <div id="scroller2" class="scroller" style="transition-property: transform; transform-origin: 0px 0px 0px; transition-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1); transform: translate(0px, 0px) translateZ(0px);">
                <div id="ranklist"></div>
            </div>
        </div>
    </div>

    <script>
        $(".wrapper").height(Math.round($(window).height()) - c_height - 106);
        $(".wrapper_c").height(Math.round($(window).height()) - c_height - 106);
    </script>
</div>

<!-- 底部 -->
<div class="bottom_panel top_line">
    <div class="bottom_panel_c">
        <div class="bottom_btn good">
            <em id="like_num">428</em>
            <span class="action" data-type="like">
                <i class="fa fa-heart " style=" -webkit-animation: tada 1s infinite ease-in-out;"></i>
                <i class="fa fa-heart" style=" position: absolute; bottom: 18px; left: 2px; -webkit-animation: fadeOutUp 1.2s infinite ease-in-out;"></i>
                <i class="fa fa-heart" style=" position: absolute; bottom: 18px; left: 14px; -webkit-animation: fadeOutUp 0.8s infinite ease-in-out;"></i>
                <i class="fa fa-heart" style=" position: absolute; bottom: 18px; left: 18px; -webkit-animation: fadeOutUp 1s infinite ease-in-out; "></i>
            </span>
        </div>
        <div class="bottom_table write">
            <div class="table_input" id="btn_comment">说点什么吧~</div>
        </div>
        <div class="bottom_btn gift animated tada" id="btn_gift">
            <em>送礼</em>
            <span>
                <i class="fa fa-gift"></i>
            </span>
        </div>
    </div>
</div>

<!-- 评论弹出框 -->
<div class="comment_panel">
    <div class="comment_panel_c">
        <div class="comment_btn comment_close">
            <span>
                <i class="fa fa-times"></i>
            </span>
        </div>

        <form id="commentform" method="post" onsubmit="return false;">
            <input type="hidden" name="formhash" value="af0d905c">
            <input type="hidden" name="commetsubmit" value="yes">
            <input type="hidden" name="chid" value="22">

            <div class="comment_table write">
                <div class="table_input" id="btn_comment">
                    <input id="comment_input" type="text" name="message1"></div>
            </div>

            <div class="comment_btn btn" id="comment_sub">
                <span>提交</span>
            </div>

        </form>
    </div>
</div>

<!-- 礼物弹出框 -->
<div>
    <div class="weui_mask weui_mask_transition weui_fade_toggle" id="pop_mask"></div>
    <div class="pop_gift animated none" id="gift">
        <ul class="bottom_line">
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="7">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160519e4i4knwdyrwtwhqc.png"></i>
                    <span>金币</span>
                    <span class="pop_gift_text">￥0.80</span>
                </a>
            </li>
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="6">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160500cptulkbxaia227ls.png"></i>
                    <span>鲜花</span>
                    <span class="pop_gift_text">￥1.00</span>
                </a>
            </li>
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="8">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160620bpimqa4d61w08d00.png"></i>
                    <span>蛋糕</span>
                    <span class="pop_gift_text">￥2.00</span>
                </a>
            </li>
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="9">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160650vh0o0fou5f4c471c.png"></i>
                    <span>柠檬茶</span>
                    <span class="pop_gift_text">￥5.00</span>
                </a>
            </li>
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="10">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160731jswncy1zewu6n2u9.png"></i>
                    <span>钻戒</span>
                    <span class="pop_gift_text">￥8.00</span>
                </a>
            </li>
                        <li>
                <a class="dj-xw" href="javascript:void(0)" data-id="11">
                    <i><img src="data/attachment/singcere_file/xn_live/201607/12/160745z388y5b5b0zyc8wc.png"></i>
                    <span>宝箱</span>
                    <span class="pop_gift_text">￥18.00</span>
                </a>
            </li>
                    </ul>
        <div class="pop_gift_off">
            <dd class="fa fa-power-off" id="power_gift_off"></dd>
        </div>
    </div>
</div>

<!-- 加载中 -->
<div id="SC_loading" style="display:none">
    <div class="mp_loading_clip">
        <div class="mp_loading_bar"></div>
    </div>
</div>

<div class="weui_dialog_alert" id="dialog3" style="display:none">
    <div class="weui_mask"></div>
    <div class="weui_dialog">
        <div class="weui_dialog_hd"> <strong class="weui_dialog_title">提示</strong>
        </div>
        <div class="weui_dialog_bd" id="tip"></div>
        <div class="weui_dialog_ft">
            <a href="javascript:;" class="weui_btn_dialog primary" onclick="$('#dialog3').hide()">确定</a>
        </div>
    </div>
</div>

<div id="loadingToast" class="weui_loading_toast" style="display: none;">
    <div class="weui_mask_transparent"></div>
    <div class="weui_toast">
        <div class="weui_loading">
            <div class="weui_loading_leaf weui_loading_leaf_0"></div>
            <div class="weui_loading_leaf weui_loading_leaf_1"></div>
            <div class="weui_loading_leaf weui_loading_leaf_2"></div>
            <div class="weui_loading_leaf weui_loading_leaf_3"></div>
            <div class="weui_loading_leaf weui_loading_leaf_4"></div>
            <div class="weui_loading_leaf weui_loading_leaf_5"></div>
            <div class="weui_loading_leaf weui_loading_leaf_6"></div>
            <div class="weui_loading_leaf weui_loading_leaf_7"></div>
            <div class="weui_loading_leaf weui_loading_leaf_8"></div>
            <div class="weui_loading_leaf weui_loading_leaf_9"></div>
            <div class="weui_loading_leaf weui_loading_leaf_10"></div>
            <div class="weui_loading_leaf weui_loading_leaf_11"></div>
        </div>
        <p class="weui_toast_content" id="cmittip">数据加载中</p>
    </div>
</div>

<div id="toast" style="display: none;">
    <div class="weui_mask_transparent"></div>
    <div class="weui_toast">
        <i class="weui_icon_toast"></i>
        <p class="weui_toast_content" id="successtip"></p>
    </div>
</div>

<script>
    $(".dj-xw").on('click', function() {
        showProgress("提交中...");
        var gid = parseInt($(this).attr('data-id'));
        if (!gid) {
            showWarming("请选择一个礼物！");
            return;
        }
        $('#power_gift_off').click();

        $.ajax({
            'type': 'POST',
            'data': {
                'gid': gid,
                'formhash': "af0d905c",
                'paysub': 'yes',
                'num': 1,
                'chid': "22"
            },
            'url': "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=sendgift&handlekey=pay&inajax=1",
            'dataType': 'xml'
        }).success(function(s) {
            $("#loadingToast").hide();
            evalscript(s.lastChild.firstChild.nodeValue);
        }).error(function() {});
    });

    function errorhandle_pay(msg, param) {
        if (param.errorcode == 1) {
            showWarming(msg);
        } else {
            var wxparam = eval("(" + param.wxparam + ")");
            WeixinJSBridge.invoke(
                'getBrandWCPayRequest',
                wxparam,
                function(res) {
                    tid = $("#tid").val();
                    if (res.err_msg == "get_brand_wcpay_request:ok") {
                        showSuccess("支付成功", 500);
                        loadingNewComment(1);
                    }
                    if (res.err_msg == "get_brand_wcpay_request:cancel") {
                        showSuccess("已取消", 500);
                    }
                }
            );
        }
    }
</script>

<script type="text/javascript">
var myScroll, myScroll1, myScroll2,
    pullDownEl, pullDownOffset,
    generatedCount = 0;
pullDownEl = document.getElementById('pullDown');
pullDownOffset = pullDownEl.offsetHeight;

var end = "0";
var start = "1466836320";
var lastCid = 0;
var preCid = 0;

$('#stop').click(function() {
        $('.content').addClass('content_top_off')
    });

    $('#btn_comment').click(function() {
        $('.comment_panel').show();
        $('.bottom_panel').hide();
        $('.view').hide();
        $("#comment_input").focus();
    });

    $('#btn_gift').click(function() {
        $('#pop_mask').show();
        $('#gift').removeClass('none slideOutDown').addClass('slideInUp');
    });

    $('#power_gift_off').click(function() {
        $('#pop_mask').hide();
        $('#gift').removeClass('slideInUp').addClass('slideOutDown');
    });

    $('.comment_close').click(function() {
        $('.comment_panel').hide();
        $('.view').show();
        $('.bottom_panel').show();
    });

    $("#comment_sub").on('click', function() {
         message = $("#comment_input").val();
        if (message == '') {
            showWarming("评论内容不能为空");
            return;
        }
    
        $('.comment_close').click();
        showProgress("提交中...");
        $.ajax({
            type: 'POST',
            data: $("#commentform").serialize(),
            url: "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=comment&handlekey=comment&inajax=1&message="+message,
            dataType: 'xml'
        }).success(function(s) {
            $("#loadingToast").hide();
            runscript(s.lastChild.firstChild.nodeValue);
        }).error(function() {});

    });
    
document.addEventListener('touchmove', function(e) {
    e.preventDefault();
}, false);

function showWarming(msg) {
    $("#tip").html(msg);
    $("#dialog3").show();
}

function showProgress(msg) {
    $("#cmittip").html(msg);
    $("#loadingToast").show();
}

function showSuccess(msg, time) {
    $("#successtip").html(msg);
    $("#toast").show();

    setTimeout(function() {
        $("#toast").fadeOut();
    }, time);
}

pullDownEl = document.getElementById('pullDown');
pullDownOffset = pullDownEl.offsetHeight;

myScroll = new iScroll('wrapper', {
    scrollbars: true,
    useTransition: true,
    topOffset: pullDownOffset,
    onRefresh: function() {
        if (pullDownEl.className.match('loading') && endFetchOld == 0) {
            pullDownEl.className = '';
            pullDownEl.querySelector('.pullDownLabel').innerHTML = '拉我刷新...';
        }
    },
    onScrollMove: function() {
        if (this.y > 5 && !pullDownEl.className.match('flip') && endFetchOld == 0) {
            pullDownEl.className = 'flip';
            pullDownEl.querySelector('.pullDownLabel').innerHTML = '放开我开始更新...';
            this.minScrollY = 0;
        } else if (this.y < 5 && pullDownEl.className.match('flip')) {
            pullDownEl.className = '';
            pullDownEl.querySelector('.pullDownLabel').innerHTML = '拉我刷新...';
            this.minScrollY = -pullDownOffset;
        }

    },

    onScrollEnd: function() {
        if (pullDownEl.className.match('flip') && endFetchOld == 0) {
            pullDownEl.className = 'loading';
            pullDownEl.querySelector('.pullDownLabel').innerHTML = '玩命加载中...';
            loadingOldComment(0);
        }
    }
});
var type = ''  ;
$(".action").on('click', function() {
    type = $(this).attr('data-type');
    if(type == 'subscribe')
        showProgress("提交中...");
    $.ajax({
        'type': 'POST',
        'data': {
            'formhash': "af0d905c",
            'actionsub': 'yes',
            'num': 1,
            'chid': "22",
            'type': type
        },
        'url': "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=channelaction&handlekey=action&inajax=1",
        'dataType': 'xml'
    }).success(function(s) {
        $("#loadingToast").hide();
        runscript(s.lastChild.firstChild.nodeValue);
    }).error(function() {});
});

function errorhandle_action(msg, param) {
    if (param.errorcode == 1) {
        showWarming(msg);
    } else {
        $("#guanzhu_num").html(param.subscribes);
        $("#like_num").html(param.likes);
        if(type == 'subscribe'){
            showSuccess(msg, 800);
        }
        
    }
}

function errorhandle_comment(msg, param) {
    if (param.errorcode == 1) {
        showWarming(msg);
    } else {
        $("#comment_num").html(param.comments);
        showSuccess("评论成功", 800);
        $("#comment_input").val('');
$("#w_chat").click();
        loadingNewComment(1);

    }
}
var recordTPL2 = '<div class="tall"><div class="red_ground animated pulse infinite"><li></li></div><div class="tall_red"><ul class="red_LImg LImg" >[img]</ul><p class="red_name">[username]：</p><p class="red_text">送给主播[message]</p></div></div>';
var recordTPL1 = '<div class="tall"><ul class="LImg">[img]</ul><ul class="tall_b"><p><span class="name">[username]：</span>[message]</p></ul></div>';
var endFetchNew = 0;
var endFetchOld = 0;
var initHeight = 0;

function loadingNewComment(scroll) {
    $.ajax({
        'type': 'POST',
        'data': {
            'formhash': "af0d905c",
            'status':"0",
            'end': end,
            'type':'3',
            'start': start,
            'chid': "22",
            'lastCid': lastCid
        },
        'url': "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=ajaxlist&action=commentlist",
        'dataType': 'json'
    }).success(function(jsondata) {
        tpl = '';
        if (jsondata['nochanel'] == 1 || jsondata['notstart']) {
            endFetchNew = 1;
        } else {
            
                endFetchNew = jsondata['livefinsh'] == 1?1:0;
            
            if (jsondata['comments'].length > 0) {
                lastCid = jsondata['lastcid'];
                preCid = jsondata['prevcid'];
                for (i = 0; i < jsondata['comments'].length; i++) {
                    item = jsondata['comments'][i];
                    if (item.idtype == 1) {
                        html = recordTPL1.replace("[message]", item.message);
                        html = html.replace("[username]", item.username);
                        html = html.replace("[img]", item.img);
                    } else {
                        html = recordTPL2.replace("[message]", item.message);
                        html = html.replace("[username]", item.username);
                        html = html.replace("[img]", item.img);
                    }
                    tpl += html;
                }
                if (tpl) {

                    $("#comments").append(tpl);
                    if (initHeight == 0) {
                        initHeight = document.getElementById('comments').offsetHeight;
                    }

                }
            }
    }
        resetRefesh(scroll);
    }).error(function() {});
}

setInterval(function() {
    if (endFetchNew == 0) {
        loadingNewComment(0);
    }
}, 10000);

loadingNewComment(0);

function loadingOldComment() {
    $.ajax({
        'type': 'POST',
        'data': {
            'formhash': "af0d905c",
            'chid': "22",
            'preCid': preCid
        },
        'url': "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=ajaxlist&action=historycomment",
        'dataType': 'json'
    }).success(function(jsondata) {

        tpl = '';
        if (jsondata['nochanel'] == 1) {
            endFetchOld = 1;
        } else {

            if (jsondata['comments'].length > 0) {
                preCid = jsondata['precid'];
                for (i = 0; i < jsondata['comments'].length; i++) {
                    item = jsondata['comments'][i];
                    if (item.idtype == 1) {
                        html = recordTPL1.replace("[message]", item.message);
                        html = html.replace("[username]", item.username);
                        html = html.replace("[img]", item.img);
                    } else {
                        html = recordTPL2.replace("[message]", item.message);
                        html = html.replace("[username]", item.username);
                        html = html.replace("[img]", item.img);
                    }
                    tpl += html;
                }
                if (tpl) {
                    $("#comments").prepend(tpl);
                }
                $('.pullDownLabel').html('(￣ˇ￣)拉我刷新...');
            } else {
                endFetchOld = 1;
                $('.pullDownLabel').html('已经到顶了');
            }
            
            myScroll.scrollTo(0, -pullDownOffset, 0);
            myScroll.refresh();
        }
    }).error(function() {});
}

function resetRefesh(scroll) {
    divoffset = document.getElementById('comments').offsetHeight;
    if (divoffset <= initHeight || scroll) {
        myScroll.scrollTo(0, -divoffset, 3);
    }
    myScroll.refresh();
}


$('#l_gift').click(function() {
    var divObj = $("#wrapper2");
    $('#l_gift').addClass('cur');
    $('#w_chat').removeClass('cur');
    $('#i_live').removeClass('cur');
    $('#wrapper').hide();
    $('#wrapper1').hide();
    divObj.show();
    if (divObj.find("div.second_box").length == 0) {
        loadingGiftRank();

    }
    myScroll1.refresh();
    myScroll.refresh();
    myScroll2.refresh();
});

var topTPL = '<div class="second_box"><div class="second"><div class="second_tall normal"><span class="[class]" ></span><div class="second_img normal_img" data-uid="242964">[img]</div><dl class="bottom_line"><em>[position]</em><dt>[username]</dt><dd><i class="fa fa-gift"></i>[gifts]</dd></dl></div></div></div>';

function loadingGiftRank() {
    $("#SC_loading").show();
    $.ajax({
        'type': 'POST',
        'data': {
            'formhash': "af0d905c",
            'chid': "22",
        },
        'url': "http://www.pt163.com/plugin.php?" + "id=xn_live&mod=ajaxlist&action=giftrank",
        'dataType': 'json'
    }).success(function(jsondata) {
        tpl = '';
        $("#SC_loading").hide();
        if (jsondata['nodata'] == 1) {
            $("#ranklist").html("<div class='null'></div>");
        } else {

            if (jsondata['toprank'].length > 0) {
                for (i = 0; i < jsondata['toprank'].length; i++) {
                    item = jsondata['toprank'][i];
                    html = topTPL.replace("[gifts]", item.gifts);
                    html = html.replace("[username]", item.username);
                    html = html.replace("[position]", item.position);
                    html = html.replace("[img]", item.img);

                    if (item.position == 1) {
                        html = html.replace("[class]", 'one');
                    } else if (item.position == 2) {
                        html = html.replace("[class]", 'two');
                    } else if (item.position == 3) {
                        html = html.replace("[class]", 'three');
                    } else {

                        html = html.replace("[class]", 'after');
                    }
                    tpl += html;
                }

                if (tpl) {
                    $("#ranklist").append(tpl);
                }
                myScroll2.refresh();
            }
        }
    }).error(function() {});
}


myScroll2 = new iScroll('wrapper2', {
    scrollbars: true,
    useTransition: true
});
myScroll1 = new iScroll('wrapper1', {
    scrollbars: true,
    useTransition: true
});
myScroll2.refresh();

$('#i_live').click(function() {
    $('#l_gift').removeClass('cur');
    $('#w_chat').removeClass('cur');
    $('#i_live').addClass('cur');
    $('#wrapper').hide();
    $('#wrapper1').show();
    $('#wrapper2').hide();
    myScroll1.refresh();
    myScroll.refresh();
    myScroll2.refresh();
});
</script>

<script>
var stateObj = {
    foo: "bar"
};
$('#w_chat').click(function() {
        $('#l_gift').removeClass('cur');
        $('#w_chat').addClass('cur');
        $('#i_live').removeClass('cur');
        $('#wrapper').show();
        $('#wrapper1').hide();
        $('#wrapper2').hide();
        myScroll1.refresh();
        myScroll.refresh();
        myScroll2.refresh();
    });
</script>

</div></body></html>