{php $g_title='问题列表'}{php $menu='2'}{template 'common/header1'}		{php $menus = M('topmenu')->getall(" AND onlymain='0' ",array('page'=>'index'))}		{php $width = round(100/count($menus),2)}		<style type="text/css">		textarea,select,input{-webkit-appearance: none; -moz-appearance: none; -o-appearance: none; appearance: none;}		li{list-style:none}		.child{			float: left;			height: 40px;			width: 25%;			margin-top: 8px;			box-sizing: border-box;			background-clip: content-box;		}		.child img{			height:45px;			width:45px;		}		.cname{			position: absolute; 			z-index: 1;			color: #000; 			overflow: hidden; 			margin-top:50px;			width:80px;			line-height:20px;			font-size:13px;			text-align:center;			margin-left:-62px;		}		.split-line{			background-color:#efeef3;			height:10px;			margin-left:-10px;			margin-right:-10px;		}		input::-webkit-input-placeholder,		textarea::-webkit-input-placeholder {			color: #B3B1B1;		}		input {			border:1px solid #ECECEC;			float:left;			text-align: center;			border-radius:100px;			background-color:#FDFDFD;			width:75%;			height:30px;			margin:10px 20px 10px 10px;		}		.search {			font-size:20px;			color:#B3B1B1;			padding-top:10px;		}		/*		 */		/* height width line-height */		/* left right top bottom */		/* padding margin */		/* font-size */		/* border */		.error-popup .error-popup-hd i {		  font-size: 40px;		  color: #ffffff;		}		li{list-style:none}		.error-popup .error-popup-bd {		  margin-top: 10px;		  line-height: 20px;		}		.com-answers-list-header {		  position: fixed;		  z-index: 2;		  top: 0px;		  left: -28px;		  width: 110%;		  height: 50px;		  line-height: 50px;		  background: #ffffff;		  padding: 0;		  color: #999999;		  text-align: center;		}		.com-answers-list-header .answers-list-header-wrap {		  position: relative;		  max-width: 768px;		  margin: 0 auto;		}		.com-answers-list-header .answers-list-header-bd .items.navs {		  background: #ffffff;		}		.com-answers-list-header .answers-list-header-bd .items.navs .item.nav {		  float: left;		  display: inline-block;		  width: {$width}%;		  text-align: center;		  border-bottom: 1px solid #ebebeb;		  padding: 0;		  margin-bottom:0px;		}		.com-answers-list-header .answers-list-header-bd .items.navs .item.nav .link {		  position: relative;		  display: block;		}		.com-answers-list-header .answers-list-header-bd .items.navs .item.nav .link .txt {		  position: relative;		  display: inline-block;		  height: 50px;		  line-height: 50px;		  color: #999999;		  padding: 0 4px;		}		.com-answers-list-header .answers-list-header-bd .items.navs .item.nav .link .txt .tip {		  display: inline-block;		  position: absolute;		  top: 10px;		  right: 0;		  width: 6px;		  height: 6px;		  background: #FF644A;		  border-radius: 50%;		}		.com-answers-list-header .answers-list-header-bd .items.navs .item.nav.active .link .txt {		  color: #27ae60;		  border-bottom: 3px solid #27ae60;		}		.com-answers-list-header .answers-list-header-ft {		  left: 0;		  right: 0;		  height: 0;		  background: rgba(0, 0, 0, 0.4);		  -webkit-transition: opacity 250ms;		  -moz-transition: opacity 250ms;		  transition: opacity 250ms;		  -ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);		  filter: alpha(opacity=0);		  opacity: 0;		  overflow: hidden;		  z-index: 20;		  display:none;		}		.com-answers-list-header .answers-list-header-ft.show {		  height: auto;		  bottom: 0;		  -ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);		  filter: alpha(opacity=100);		  opacity: 1;		  display:block;		}		.com-answers-list-header .answers-list-header-ft .items.navs {		  display: -webkit-box;		  display: -webkit-flex;		  display: -ms-flexbox;		  display: flex;		  flex-wrap: wrap;		  background: #ffffff;		  max-width: 768px;		  margin: 0 auto;		}		.com-answers-list-header .answers-list-header-ft .items.navs .item.nav {		  -webkit-box-flex: 0 0 25%;		  -webkit-flex: 0 0 25%;		  -ms-flex: 0 0 25%;		  flex: 0 0 25%;		  text-align: center;		  border-bottom: 1px solid #ebebeb;		  padding: 0;		  font-size: 14px;		  border-right: 1px solid #ebebeb;		}		.com-answers-list-header .answers-list-header-ft .items.navs .item.nav .link {		  display: block;		  height: 50px;		  line-height: 50px;		  color: #666666;		  padding: 0;		}		.com-answers-list-header .answers-list-header-ft .items.navs .item.nav.active .link {		  color: #27ae60;		}		.answers-list-header-ft li{			margin-bottom:0px;		}		.answer-tag {		  float: left;		  font-size: 14px;		  color: #999999;		  line-height: 14px;		  background: #F0F0F0;		  padding: 6px 6px;		  border-radius: 4px;		  margin-right: 4px;		  padding-top:6px;		}		.answer-time {		  font-size: 12px;		  color: #C5C4C4;		  line-height: 12px;		}    		.mask {       			position: absolute; top: 0px; filter: alpha(opacity=60); background-color: #000;     			z-index: 1002; left: 0px;     			opacity:0.6; -moz-opacity:0.6;    			width:120%;			left:-18px;		}		</style>		<div class="com-answers-list-header" data-currentuserid="" data-initialized="true" data-guid="0">			<div class="answers-list-header-wrap">				<div class="answers-list-header-bd swiper-container swiper-container-horizontal swiper-container-free-mode">					<ul class="items navs swiper-wrapper clearfix">						{loop $menus $m}						<li class="item nav swiper-slide {if $act==$m['type'] && ($m['type']!='spec' || ($cid==$m['cateid'] && $act=='spec'))}active swiper-slide-active{/if}">						{if $m['type']=='outlink'}							<a class="link tag" href="{$m['link']}"><span class="txt">{$m['title']}</span></a>						{else if $m['type']=='cate'}							<a id='catemore' class="link tag" href="#"><span class="txt">{$m['title']}</span></a>						{else}							<a class="link tag" href="{php echo $this->createMobileUrl('index',array('cid'=>$m['cateid'],'act'=>$m['type']))}"><span class="txt">{$m['title']}</span></a>						{/if}						</li>						{/loop}					</ul>				</div>				<div class="answers-list-header-ft">					<ul class="items navs">						<li class="item nav">						<a class="link tag-more" href="{php echo $this->createMobileUrl('index',array('act'=>'new'))}">全部</a>						</li>						{php $category = M('category')->getByType(2)}						{loop $category $c}						<li class="item nav">						<a class="link tag-more" href="{php echo $this->createMobileUrl('index',array('cid'=>$c['id'],'act'=>'cate'))}">{$c['title']}</a>						</li>						{/loop}					</ul>				</div>			</div>		</div>		{template 'common/menu'}		<div id="content" class="snap-content">			<div class="content"> 				<div style='padding-top:50px;' class="portfolio-filter">					{if !empty($questions['list'])}					<div id="questions" class="portfolio-filter-wrapper" style="margin-left:5px;">						{loop $questions['list'] $li} 						{php $to_member = M('member')->getInfo($li['to_openid'])}						{if $li['istask']=='1'}						<div class="blog-sidebar-text" onclick="window.location.href='{php echo $this->createMobileUrl('task_answer',array('id'=>$li['id']))}'">							{php $quser = M('member')->getInfo($li['openid'])}							<h5 style="font-size:15px;">								{php $cate = M('category')->getInfo($li['category_id'])}								<span class="answer-tag">{$cate['title']}</span>								{$li['title']}								{if $this->pro['openImgShow']=='1' && !empty($li['images'])}								<div style="padding-top:.3rem;" class="lookImage pic_list">									{php $images = unserialize($li['images'])}									{php $count=0}									{loop $images $image}									{php $count++}									{if $count<5}									<span><img style="height:75px;width:75px;" class='imagesShowArea' src="{php echo tomedia($image)}" alt=""></span>									{/if}									{/loop}								</div>								{/if} 							</h5> 						</div>						<div class="container one-third-responsive" onclick="window.location.href='{php echo $this->createMobileUrl('task_answer',array('id'=>$li['id']))}'">							{php $ans = M('answer')->getone(array('question_id'=>$li['id'],'ispick'=>'1'))}							{php $user = M('member')->getInfo($ans['openid'])}							{php $count = M('answer')->getTotal(array('question_id'=>$li['id']))}							<p class="user-list-follow">								{if $li['isanonymous']=='1'}								<img class='avatar' src="{MODULE_URL}assets/images/anonymous_avatar.jpg" alt="img">								<strong {if $li['credit']<=0 && $count<=0}style='padding-top:10px;'{/if}>匿名用户提问								{else}								<img class='avatar' src="{php echo $quser['avatar']}" alt="img">								<strong {if $li['credit']<=0 && $count<=0}style='padding-top:10px;'{/if}>{$quser['nickname']}提问								{/if}									{php $time = $hour2-intval((time()-$li['create_time'])/3600)}									{php $mark = $li['status']=='2' || $time<=0}									<em>										{if $li['credit']>0}赏金{$li['credit']}元&nbsp;&nbsp;&nbsp;{/if}{if $count>0}{$count}人已抢答{/if}									</em>								</strong>								{if !$mark}								<a href="{php echo $this->createMobileUrl('task_answer',array('id'=>$li['id']))}" style='margin-bottom:10px;' class="follow2 button-orange"><span class="tip">还剩{$time}小时</span></a>								{else}									{if empty($ans)}										<a href="{php echo $this->createMobileUrl('task_answer',array('id'=>$li['id']))}" style='margin-bottom:10px;' class="follow2 button-green"><span class="tip">查看解答</span></a>									{else}										{if $ans['mode']=='0'}										<a data-id="{$ans['id']}" data-mode="{$ans['mode']}" data-timelong="{$ans['timelong']}" data-question_id="{$li['id']}" class="listen follow2 button-green">											<span>播放解答 {$ans['timelong']}''</span>										</a>										{else}										<a data-id="{$ans['id']}" data-mode="{$ans['mode']}" data-question_id="{$li['id']}" class="lookup follow2 button-green">											<span>查看解答</span>										</a>										{/if}									{/if}								{/if}							</p>							<div class="decoration"></div>						</div>						{else}						<div class="blog-sidebar-text" onclick="window.location.href='{php echo $this->createMobileUrl('question',array('id'=>$li['id']))}'">							{php $quser = M('member')->getInfo($li['openid'])}							<h5 style="font-size:15px;">								{php $cate = M('category')->getInfo($li['category_id'])}								<span class="answer-tag">{$cate['title']}</span>								{$li['title']}								{if $this->pro['openImgShow']=='1' && !empty($li['images'])}								<div style="padding-top:.3rem;" class="lookImage pic_list">									{php $images = unserialize($li['images'])}									{php $count=0}									{loop $images $image}									{php $count++}									{if $count<5}									<span><img style="height:75px;width:75px;" class='imagesShowArea' src="{php echo tomedia($image)}" alt=""></span>									{/if}									{/loop}								</div>								{/if}							</h5>						</div>						<div class="container one-third-responsive">							{php $ans = M('answer')->getone(array('question_id'=>$li['id']))}							{php $user = M('member')->getInfo($ans['openid'])}							<p class="user-list-follow">								<a href="{php echo $this->createMobileUrl('tutor',array('openid'=>$to_member['openid']))}">									<img src="{php echo $to_member['avatar']}" alt="img">									{if $to_member['isrecommend']=='1'}<i class="icon icon_vip"></i>{/if}									<strong>{$to_member['realname']}										<em class="split-title">{$to_member['tags']}</em>									</strong>								</a> 								{if !empty($li['isfree'])}									<a data-id="{$ans['id']}" data-mode="{$ans['mode']}" data-timelong="{$ans['timelong']}" data-question_id="{$li['id']}" class="{if $ans['mode']=='0'}listen{else}lookup{/if} follow2 button-orange">										<span class="tip">{php echo $this->template['limitFree']}</span>									</a>								{else}									{php $now = M('member')->getInfo($_W['openid'])}									{php $listen_log = M('listen_log')->getOpenid($li['id'],$_W['openid'])}									{if $ans['mode']=='0'}									<a data-id="{$ans['id']}" data-mode="{$ans['mode']}" data-timelong="{$ans['timelong']}" data-question_id="{$li['id']}" class="listen follow2 button-green">										{if empty($listen_log) || $listen_log['status'] == 0}											{if ($now['admin']=='1' || $li['openid']==$_W['openid'] || $li['to_openid'] == $_W['openid'])}											<span class="tip">播放解答 {$ans['timelong']}''</span>											{else}											<span class="tip">{php echo $this->pro['listen_price']}元{php echo $this->template['learnName']} {$ans['timelong']}''</span>											{/if}										{else}											<span>播放解答 {$ans['timelong']}''</span>										{/if}									</a>									{else}									<a data-id="{$ans['id']}" data-mode="{$ans['mode']}" data-question_id="{$li['id']}" class="lookup follow2 button-green">										{if empty($listen_log) || $listen_log['status'] == 0}										{if ($now['admin']=='1' || $li['openid']==$_W['openid'] || $li['to_openid'] == $_W['openid'])}											<span class="tip">查看解答</span>										{else}											<span class="tip">{php echo $this->pro['listen_price']}元{php echo $this->template['learnName']}</span>										{/if}										{else}											<span>查看解答</span>										{/if}									</a>									{/if}								{/if}							</p>						<div class="decoration"></div>						</div>						{/if}						{/loop}					</div>					<div id="mask" class="mask"></div>					{else}					<div class="content" style="margin-top:150px;">						<div class="show-no-detection device-detected">							<h5>暂时还没有解答哦</h5>							<a href="{php echo $this->createMobileUrl('find')}" class="button-small button-orange button-center" style="margin-top:20px;">寻找{php echo $this->template['authname']}</a>						</div>					</div>					{/if}				</div>			</div>		</div>	</div>	<div class="footer-menu-controls light-footer-menu" style="-webkit-transform:inherit;">		<div class="column" style="z-index:9999;">			<div id="sb-search" class="sb-search">				<form id="sb-form" action="{php echo $this->createMobileUrl('searchm')}" method="post">					<a href="{php echo $this->createMobileUrl('task_post')}" id="sb-icon-search" class="sb-icon-search footer-menu-open" style="filter:alpha(opacity=80); -moz-opacity:0.8; -khtml-opacity: 0.8; opacity: 0.8; transform: translateX(0px); transition: all 250ms ease;"><i class="fa fa-pencil bg-blue-dark"></i> </a>				</form>			</div>		</div>	</div>	<audio controls="controls" id="player" style="display:none;" autoplay preload="auto"></audio>	<script src="{MODULE_URL}public/js/loadmore.js"></script>		<script>    var player = document.getElementById('player');	initload("{php echo $this->createMobileUrl('index',array('cid'=>$cid,'act'=>$act))}",callback);	loadmore("{php echo $this->createMobileUrl('index',array('cid'=>$cid,'act'=>$act))}",callback);	function callback(html){		$('#questions').append(html);	}		$("#mask,#catemore").click(function(){		if($(".answers-list-header-ft").hasClass('show')){						$(".answers-list-header-ft").removeClass("show");			$("#mask").hide();  		}else{			$(".answers-list-header-ft").addClass("show"); 			$("#mask").css("height",$(document).height());     			$("#mask").css("width",$(document).width()+28);     			$("#mask").show();  		}	});	var timer;    function playData(data){        player.src = data.src;        player.play();        var timelong = parseInt(data.timelong) * 1000;		var count = data.timelong;		timer = window.setInterval(function(){			if((count--)>1){				$(data.target).find('span').html("播放中..."+count+"''");			}else{				clearInterval(timer);				$(data.target).find('span').html("再放一次 "+data.timelong+"''");			}		},1000);		/**        setTimeout(function(){			$(data.target).find('span').html("再放一次");        },timelong);*/    }	$("#content").delegate(".lookup","click",function(){		var dd = {};        var question_id = $(this).data('question_id');        var target = $(this);        if(!question_id){            warn('question_id为空');            return '';        }        $.get("{php echo $this->createMobileUrl('question')}&id="+question_id,{answer_id:$(this).data('id'),act:'src'},function(data){            if(data.status == 8){				dd.status = 2;                warn(data.message,function(){});                return '';            }            if(data.status == 0){				target.parent().parent().prev().trigger('click');                return '';            }            wx.ready(function(){                wx.chooseWXPay({                    timestamp: data.timeStamp,                    nonceStr: data.nonceStr,                    package: data.package,                    signType: data.signType,                    paySign: data.paySign,                    success: function (res) {                        if(res.errMsg == 'chooseWXPay:ok') {                            data.act == 'paySuccess';                            $.post("{php echo $this->createMobileUrl('question')}&id="+question_id,{act:'paySuccess',listen_id:data.listen_id,answer_id:data.answer_id},function(d){                                if(d.status == 1){									target.parent().parent().prev().trigger('click');                                    return '';                                }else{									dd.status = 2;                                    warn('系统错误',2000,'cancel');                                }                            },'json');                        }else{							dd.status = 2;                            window.location.href = "{php echo $_W['siteurl']}";                        }                    }                });            });        },'json');    });		$("#content").delegate(".listen","click",function(){		clearInterval(timer);		var dd = {};        var question_id = $(this).data('question_id');        var target = $(this)[0];        var timelong = $(this).data('timelong');        if(!question_id){            warn('question_id为空');            return '';        }        $.get("{php echo $this->createMobileUrl('question')}&id="+question_id,{answer_id:$(this).data('id'),act:'src'},function(data){            if(data.status == 8){				dd.status = 2;                warn(data.message,function(){});                return '';            }            if(data.status == 0){				dd.status = 1;                dd.target = target;                dd.src = data.src;                dd.timelong = timelong;                return '';            }            if(!data.listen_id){				dd.status = 2;                warn('listen_id为空');                return '';            }            if(!data.answer_id){				dd.status = 2;                warn('answer_id为空');                return '';            }            wx.ready(function(){                wx.chooseWXPay({                    timestamp: data.timeStamp,                    nonceStr: data.nonceStr,                    package: data.package,                    signType: data.signType,                    paySign: data.paySign,                    success: function (res) {                        if(res.errMsg == 'chooseWXPay:ok') {                            data.act == 'paySuccess';                            $.post("{php echo $this->createMobileUrl('question')}&id="+question_id,{act:'paySuccess',listen_id:data.listen_id,answer_id:data.answer_id},function(d){                                if(d.status == 1){									dd.status = 1;                                    dd.target = target;                                    dd.src = d.src;                                    dd.timelong = timelong;                                    return '';                                }else{									dd.status = 2;                                    warn('系统错误',2000,'cancel');                                }                            },'json');                        }else{							dd.status = 2;                            window.location.href = "{php echo $_W['siteurl']}";                        }                    }                });            });        },'json');		$(target).find('span').html("数据搬运中...");        player.play();		var timer1 = window.setInterval(function(){			if(dd.status>0){				clearInterval(timer1);				if(dd.status==1){					playData(dd);				}else{ 					$(target).find('span').html("重试一下");				}			}		},1000);    });</script>{template 'common/remind'}</body></html>