<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />	<meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">	<meta name="apple-mobile-web-app-capable" content="yes">	<meta name="apple-mobile-web-app-status-bar-style" content="black">	<meta name="format-detection" content="telephone=no">	<title>填写问题内容</title>	<link href="{MODULE_URL}assets/styles/font-awesome.css" rel="stylesheet" type="text/css">	<script type="text/javascript" src="{MODULE_URL}assets/scripts/jquery.js"></script>	<script type="text/javascript" src="{MODULE_URL}assets/scripts/elink-framework.js"></script>	<script type="text/javascript" src="{MODULE_URL}assets/scripts/noty/packaged/jquery.noty.packaged.js"></script>    <script src="http://res.wx.qq.com/open/js/jweixin-1.1.0.js"></script>	<style type="text/css">*{font-family:"Microsoft YaHei",Arial,Helvetica,sans-serif,"宋体";}</style>    <script>        var jssdkconfig = {php echo json_encode($_W['account']['jssdkconfig']);} || {};        jssdkconfig.debug = false;        jssdkconfig.jsApiList = [            'checkJsApi',            'onMenuShareTimeline',            'onMenuShareAppMessage',            'onMenuShareQQ',            'onMenuShareWeibo',            'hideMenuItems',            'showMenuItems',            'hideAllNonBaseMenuItem',            'showAllNonBaseMenuItem',            'translateVoice',            'startRecord',            'stopRecord',            'onRecordEnd',            'playVoice',            'pauseVoice',            'stopVoice',            'uploadVoice',            'downloadVoice',            'chooseImage',            'previewImage',            'uploadImage',            'downloadImage',            'getNetworkType',            'openLocation',            'getLocation',            'hideOptionMenu',            'showOptionMenu',            'closeWindow',            'scanQRCode',            'chooseWXPay',            'openProductSpecificView',            'addCard',            'chooseCard',            'openCard',			'translateVoice',            'openAddress'        ];        wx.config(jssdkconfig);        var _TUTOR_URL = "{php echo $this->createMobileUrl('tutor')}";        var _follow = "{php echo intval($_W['fans']['follow'])}";        var _openid = "{php echo $_W['openid']}";        var _qrcode = "{php echo $_W['account']['qrcode']}";    </script>    <script src="{MODULE_URL}public/libs/jquery_weui/js/swiper.js"></script>    <script src="{MODULE_URL}public/js/voice.js?t={php echo time()}"></script>     	<style type="text/css">		textarea,select,input{-webkit-appearance: none; -moz-appearance: none; -o-appearance: none; appearance: none;}		li{list-style:none}		.images-content{ 			position: absolute; 			z-index: 1;			color: #fff; 			background: rgba(0,0,0,.7); 			overflow: hidden; 			margin-top:2.5rem;			opacity:0.8;filter:alpha(opacity=80);			width:38px;			line-height:20px;			font-size:12px;			margin-left:-3.25rem;			padding-left:13px;		} 		.imagesUploadArea{ 			float:left;			width:20%;			height:50px;		} 		.icon_vip{			position:absolute;			bottom:5px;			left:22px;			background-size:80px 320px;			width:26px;			height:26px;			background-position:0px 0;			background-image:url({MODULE_URL}assets/images/icon.png?t=234143);					}		label {color:#9E9E9E;font-size:12px;cursor:pointer;float:left;padding-left:30px;}		label i {font-size:12px;font-style:normal;display:inline-block;width:12px;height:12px;text-align:center;line-height:12px;color:#efeef3;vertical-align:middle;margin:-2px 2px 1px 0px;border:#28b7a3 1px solid;}		input[type="checkbox"],input[type="radio"] {display:none;}		input[type="radio"] + i {border-radius:7px;}		input[type="checkbox"]:checked + i,input[type="radio"]:checked + i {background:#28b7a3;}		input[type="checkbox"]:disabled + i,input[type="radio"]:disabled + i {border-color:#ccc;}		input[type="checkbox"]:checked:disabled + i,input[type="radio"]:checked:disabled + i {background:#ccc;}	</style>     <link href="{MODULE_URL}assets/styles/jquery.searchableSelect.css" rel="stylesheet" type="text/css">	</head> <body bgcolor="#efeef3" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"><div align="center">    <div>		<div onclick="window.location.href='{php echo $this->createMobileUrl('tutor',array('openid'=>$member['openid']))}'" style="z-index:100;border-radius:5px;background-color:#FFF;position:absolute;height:60px;width:100%;top:20px;">			<li style="height:100%;">				<div style="border-color: blue rgb(25%,35%,45%) #909090 red;border-width:1px;">					<div style="padding-top:5px;width:95%">						<div>							<div style="float:left;width:55px; height:50px;">								<img src="{php echo $member['avatar']}" style="border-radius:50px;height:50px;">								{if $member['isrecommend']=='1'}<i style='bottom:0px;left:40px;' class="icon icon_vip"></i>{/if}							</div>							<div align="left" style="padding-top:5px;padding-left:70px;font-size:12px;height:50px;"> 								<div><a style='font-size:14px;color:#4C4C4C;font-weight:bold;'>{$member['realname']}</a></div>								<div style='padding-top:3px;color:#9C9A9A;'><a>{$member['tags']}</a></div>							</div>							<div style="float:right;margin-top:-2.5rem;padding-right:10px;font-size:1.5rem;color:#BFBFBF;height:50px;"> 								<i class="fa fa-angle-right" aria-hidden="true"></i>							</div>						</div>					</div>				</div>			<li>		</div>		<div style="z-index:100;background-color:#FFF;position:absolute;height:18rem;width:100%;top:100px;">			<li style="height:100%;">				<textarea maxlength="120" name="title" id='title' placeholder="请输入述题目内容，也可以拍照上传题目照片，更容易获得{php echo $this->template['authname']}的专业回答。{if $member['credit']>0}支付{$member['credit']}元向{$member['realname']}{php echo $this->template['authname']}提问，超过{php echo $this->pro['rebateHour1']}小时未回答，可取消问题返款。{/if}" style="outline:none;padding:1rem 0 10px .5rem;width:92%;height:125px;border:none;font-size:0.8rem;">{$_SESSION['question_content']}</textarea>				<div style="border-color: blue rgb(25%,35%,45%) #909090 red;border-width:1px;">					<div style="width:85%">						<div id='imagesTr'> 							<div align="right" style="border-bottom:1px solid #E4E1E1;display:block;font-size:15px;color:#DCDCDC;height:15px;line-height:15px;padding-bottom:5px;"><span id='voiceSpan'><i class="fa fa-microphone"></i> 语音</span><span style="padding-left:.8rem;" id='saveStatus'></span><span id='count'>0</span>/120</div>							<div class="imagesUploadIcon" style="margin-top:.5rem;float:left;border:1px dashed #DCDCDC;width:55px; height:50px;">								<img src="{MODULE_URL}assets/images/pictures/tianjia.jpg" style="height:50px;">							</div>							<div align="left" class='imagesUploadDesc' style="margin-top:.5rem;padding-left:70px;font-size:12px;color:#DCDCDC;height:50px;">								<a>上传与问题相关的图片</a><br>								<a>最多可选5张</a>							</div>						</div>					</div>				</div>				<ul style="z-index:999;" class="select">					<li class="select-list">  						<dl id="category">							<dd data-cid='0' class="selected"><a>分类</a></dd>							{php $labels = explode(',',$member['labels'])}							{loop $labels $lt}							{if !empty($lt)}	 							{php $c = M('category')->getInfo($lt)}							<dd data-cid='{$c['id']}'><a>{$c['title']}</a></dd>							{/if}							{/loop}						</dl>					</li>				</ul> 			<li>		</div>		<div style="z-index:100;border-radius:5px;position:absolute;width:90%;top:415px">						<label><input type="checkbox" name="open" id="open" checked="checked"><i>✓</i> 公开我的问题</label>		</div> 		<div style="z-index:100;border-radius:5px;position:absolute;left:5%;width:90%;top:445px">	        <input id="postQuestion" style="border:none;;margin:0 0 30px 0;background:#28b7a3;border-radius:5px;line-height:40px;font-size:18px;color:#FFF;width:100%;height:40px;text-align:center"  value="{if $member['credit']>0}支付{$member['credit']}元提问{else}写好了{/if}" type=submit>	    </div>    </div>	<script>	var timerId;	var localIds;	var images = {		localId: [],		serverId: []	};		$("dd").click(function () {		$(this).addClass("selected").siblings().removeClass("selected");	});	    $('#voiceSpan').click(function(){		swal({		  title: "准备好录音了吗？",		  text: "点击开始录音就可以开始说话了哦",		  showCancelButton: true,		  confirmButtonColor: "#DD6B55",		  confirmButtonText: "开始录音",		  cancelButtonText: "先不录了",		  closeOnConfirm: false		},function(){			voice.start();			swal({			  title: "录音中...",			  showCancelButton: false,			  confirmButtonColor: "#DD6B55",			  confirmButtonText: "停止录音",			  closeOnConfirm: false			},function(){				voice.stop();				swal({				  title: "录音完成了！",				  text: "试听一下或者直接上传吧",				  showCancelButton: true,				  confirmButtonColor: "#DD6B55",				  confirmButtonText: "上传录音",				  cancelButtonText: "试听一下",				  closeOnConfirm: false,				  closeOnCancel: false				},function(isConfirm){					if(isConfirm) {						wx.uploadVoice({							localId: post.localId,							isShowProgressTips: 1,							success: function (res) {								post.serverId = res.serverId;								swal("恭喜!", "语音上传成功", "success");							}						});					}else {						voice.play();					}				});			});		});	});		$("#count").html($("#title").val().length);	window.setInterval(countChar, 1000); 	function countChar(){		$content = $("#title").val();		if($content.length>0 && $content.length<=86){			$("#count").html($("#title").val().length);			if($content.length>10){				$.post("{php echo $this->createMobileUrl('making')}&openid={$member['openid']}",{act:'saveQuestionContent',content:$("#title").val()},function(data){					if(data.status == 1){						$("#saveStatus").html("已保存 ");					}				},'json');			}		}else{			$("#saveStatus").html("");			$("#title").val($("#title").val().substr(0,86));			$("#count").html($("#title").val().length);			return;		}    }		$("#imagesTr").delegate(".imagesUploadIcon,.imagesUploadDesc,.imagesUploadArea","click",function(){		var that =$(this);			if(that.data('edit')=='1'){			that.remove();			$(".imagesUploadIcon").show();			return false;		}				images.localId = [];		var canChooseCount = 5;		$('.imagesUploadArea').each(function(){			if($(this).data('edit')=='1') canChooseCount--;		});		wx.chooseImage({			count: canChooseCount,			sizeType: ['original', 'compressed'],			sourceType: ['album', 'camera'],			success: function (res) {			images.localId = res.localIds;			if (images.localId.length == 0) {				warn('请先使用 chooseImage 接口选择图片');				return;			}			if(images.localId.length > 5) {				warn('最多支持5张照片,请重新选择');				images.localId = [];				return;			}			var i = 0, length = images.localId.length;			images.serverId = [];			$('.imagesUploadDesc').hide();			function upload() {				wx.uploadImage({					localId: images.localId[i],					success: function (res) {								$('.imagesUploadIcon').before('<div align="left" class="imagesUploadArea" data-sid="'+res.serverId+'" data-edit="1">'							+'<img id="imagePreview" src="'+images.localId[i]+'" style="padding-top:.5rem;width:53px;height:53px;"><span class="images-content">删除<span></div>');									i++;						if (i < length) {							upload();						}						var count = 0;						$('.imagesUploadArea').each(function(){							if($(this).data('edit')=='1'){								count++;							}						});						if(count>=5){							$(".imagesUploadIcon").hide();						}					},					fail: function (res) {						warn(JSON.stringify(res));					}				});			}			upload();		  }		});	});	    $('#postQuestion').click(function(){		_q = $(this);		post.title = $('textarea[name="title"]').val();		if($('input[name="open"]').is(':checked')){			post.open = '1';		}else{			post.open = '0';		}		if($('input[name="usePoint"]').is(':checked')){			post.usePoint = '1';		}else{			post.usePoint = '0';		}        post.category_id = $('#category').children(".selected").data('cid');		post.act = 'post_question';		if(!post.title){			warn('您还没有填写内容哦');			return ;		}		if(!post.category_id){			warn('您还没有选择分类哦');			return ;		}		_q.attr("disabled","disabled");		_q.val("正在通知专家到来...");        post.images = [];		$('.imagesUploadArea').each(function(){			if($(this).data('edit')=='1'){				post.images = post.images.concat($(this).data('sid'));			}		});		$.post("",post,function(data){			if(data.status == 8){				warn(data.message,2000,function(){					_q.val("写好了");					_q.removeAttr("disabled","disabled");				});				return '';			}			if(data.status == 2){				$.post("",{act:'post_question_success',question_id:data.question_id},function(d){					bingo('提交成功',function(){						window.location.href = "{php echo $this->createMobileUrl('ask')}";					});				},'json');			}else{				_q.val("正在开启支付传送门...");				wx.ready(function(){					wx.chooseWXPay({						timestamp: data.timeStamp,						nonceStr: data.nonceStr,						package: data.package,						signType: data.signType,						paySign: data.paySign,						success: function (res) {							if(res.errMsg == 'chooseWXPay:ok') {								$.post("",{act:'post_question_success',question_id:data.question_id},function(d){},'json');                                    								bingo('提交成功',function(){									window.location.href = "{php echo $this->createMobileUrl('ask')}";								});							}else{								window.location.href = "{php echo $_W['siteurl']}";							}						},cancel:function(res){							_q.val("写好了");							_q.removeAttr("disabled");						}					});				});			}		},'json');    });	</script>{template 'common/remind'}</body></html>