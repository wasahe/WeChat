{template 'common/header'}
<ul class="nav nav-tabs">
	<li {if $op == 'display'}class="active"{/if}><a href="{php echo $this->createWebUrl('staff', array('op' => 'display'))}">{php echo $this->getFieldsLabel('staff_name');}管理</a></li>
</ul>

<!-- 列表 -->
<div class="main">
	<div class="panel panel-info">
	<div class="panel-heading">筛选</div>
	<div class="panel-body">
		<form action="./index.php" method="get" class="form-horizontal" role="form" >
			<input type="hidden" name="c" value="site" />
			<input type="hidden" name="a" value="entry" />
			<input type="hidden" name="m" value="qwx_shangmen" />
			<input type="hidden" name="do" value="staff" />
			<div class="form-group">
				<label class="col-sm-2 control-label">关键字</label>
				<div class="col-sm-6">
					<input class="form-control" placeholder="真实姓名、openid、{php echo $this->getFieldsLabel('staff_name');}名称" name="keyword" id="" type="text" value="{$_GPC['keyword']}">
				</div>
				
			</div>

			<div class="form-group">
				<label class="col-sm-2 control-label">上线状态</label>
				<div class="col-sm-4">
					<select name="online" class='form-control'>
							<option value="-1" {if $_GPC['online'] == -1} selected{/if}>全部</option>
							<option value="1" {if $_GPC['online'] == 1} selected{/if}>上线</option>
							<option value="0" {if $_GPC['online'] == 0} selected{/if}>下线</option>
					</select>
				</div>
				<div class=" col-sm-2">
					<button class="btn btn-default"><i class="fa fa-search"></i> 搜索</button>
				</div>
			</div>
		</form>
	</div>
</div>
<form action="{php echo wurl('mc', array('a' => 'member'))}" method="post" id="form1">
<div class="panel panel-default">
	<div class="panel-body table-responsive">
		<table class="table table-hover">
			<thead class="navbar-inner">
				<tr>
					<th style="width:60px;">选择</th>
					<th style="width:70px;">UID</th>
					<th >姓名</th>
					<th style="width:100px;" class="text-center">在线状态</th>
					<th style="width:240px;" class="text-left">OPENID</th>
					<th style="width:120px;" class="text-left">手机</th>
					<th style="width:160px;text-align:left;" class="text-center">工号</th>
					<th style="text-align:right; width:150px;">操作</th>
				</tr>
			</thead>
			<tbody>
				{loop $list $item}
				<tr>
					<td><input type="checkbox" name="uid[]" value="{$item['uid']}" /></td>
					<td>{$item['uid']}</td>
					<td class="text-left">
					{if $item['staff_name']}
						{$item['staff_name']}
					{else}
						{if $item['nickname']}{$item['nickname']}{else}未设置{/if}
						<br>
						{if $item['realname']}{$item['realname']}{else}未设置{/if}

					{/if}
					</td>
					<td class="text-center">
						<label data='{$item['online']}' class='label  label-default {if $item['online']==1}label-info{/if}' >{if $item['online']==1}上线{else}离线{/if}</label>
					</td>
					<td style="white-space: normal;">{$item['openid']}</td>
					<td style="white-space: normal;" class="text-left">{$item['mobile']}</td>
					<td class="text-left" style="white-space: normal;">{$item['staff_work_no']}</td>
					<td style="text-align:right;">
						{if $item['online'] == 1}
						<a href="{php echo $this->createWebUrl('staff', array('op' => 'set_online','uid'=>$item['uid'],'online'=>0))}"class="btn btn-default btn-sm" data-toggle="tooltip" data-placement="top" title="置为下线">离线</a>
						{else}
						<a href="{php echo $this->createWebUrl('staff', array('op' => 'set_online','uid'=>$item['uid'],'online'=>1))}"class="btn btn-default btn-primary btn-sm" data-toggle="tooltip" data-placement="top" title="置为上线">上线</a>
						{/if}

						<a href="{php echo $this->createWebUrl('staff', array('op' => 'post','uid'=>$item['uid']))}"class="btn btn-default btn-sm" data-toggle="tooltip" data-placement="top" title="编辑"><i class="fa fa-pencil"></i></a>

					</td>
				</tr>
				{/loop}
			</tbody>
			
		</table>
		<table class="table table-hover">
			<tr>
				<td width="60">
					<input type="checkbox" onclick="var ck = this.checked;$(':checkbox').each(function(){this.checked = ck});" />
				</td>
				<td class="text-left" width="100">
					<input name="token" type="hidden" value="{$_W['token']}" />
					<input name="do" type="hidden" value="del" />
					<input type="submit" title="从会员表中删除" class="btn btn-primary span2" name="submit" value="删除" />
				</td>
				<td class="text-right">
					{$pager}
				</td>
			</tr>

		</table>
	</div>
	</div>
</form>	

<script>
	require(['bootstrap'], function(){

		$('#form1').submit(function(){
			if($(":checkbox[name='uid[]']:checked").size() > 0){
				return confirm('删除后不可恢复，您确定删除吗？');
			}
			util.message('没有选择会员', '', 'error');
			return false;
		});

	});
</script>

