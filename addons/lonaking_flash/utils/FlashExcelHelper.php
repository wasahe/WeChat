<?php
/*
 __________________________________________________
|  Encode by BajieTeam on we7                      |
|__________________________________________________|
*/
 class FlashExcelHelper { public static function dump($header, $data = null, $filename = '') { goto ZSoM4; vHzW4: t1iBY: goto dzKy2; ZSoM4: require dirname(__FILE__) . "\57\x2e\x2e\x2f\x2e\56\57\x2e\x2e\x2f\146\x72\x61\155\145\x77\x6f\x72\x6b\x2f\154\151\142\x72\x61\162\171\x2f\160\x68\160\x65\x78\143\x65\x6c\x2f\120\110\x50\105\x78\143\x65\154\56\160\x68\160"; goto KW2jr; uCyC9: header("\x43\157\x6e\164\x65\156\x74\x2d\124\171\x70\x65\x3a\x61\x70\160\x6c\x69\143\x61\164\x69\x6f\x6e\57\x64\x6f\x77\x6e\154\157\141\x64"); goto tDfHl; ripjY: foreach ($data as $d) { goto kfXM4; kfXM4: $tmp_data = array(); goto EZUlt; lm65_: M12Ns: goto Pv3gV; EZUlt: foreach ($header as $column => $name) { $tmp_data[] = $d[$column]; ajtGB: } goto YPxTE; YPxTE: X2bKE: goto cqbAD; cqbAD: $tableData[] = $tmp_data; goto lm65_; Pv3gV: } goto oDPAF; IMKJ5: header("\103\x6f\x6e\164\x65\156\x74\55\124\171\160\145\x3a\141\160\160\x6c\151\143\x61\x74\151\157\x6e\x2f\166\156\144\x2e\x6d\x73\55\145\170\145\143\x6c"); goto evMLP; q0x6m: $tableData = array(); goto ripjY; aWsrY: XyCw3: goto L0mzA; yixei: if (!($i <= count($tableData) + 1)) { goto HS9v1; } goto NUqik; rHA_8: $i = 2; goto vlT6u; AtQ9u: PgVzW: goto museZ; dZ0E8: iicyx: goto EslgZ; GIg0a: $filename = $filename . date("\131\55\155\55\144\40\x68\55\151\55\163"); goto kMyHT; museZ: $i++; goto Cdnpn; dzKy2: $write = new PHPExcel_Writer_Excel5($excel); goto veRxt; VNEah: goto B1819; goto dZ0E8; oDPAF: elUF3: goto rHA_8; l_vNh: $write->save("\160\x68\160\72\x2f\57\x6f\x75\x74\x70\x75\164"); goto Ngi2M; XMN7k: header("\x43\x6f\x6e\x74\145\156\164\55\124\x72\141\156\x73\x66\145\162\55\x45\x6e\x63\x6f\144\x69\156\x67\72\142\x69\x6e\x61\162\171"); goto l_vNh; bjZmx: Yd_RG: goto kn3xB; vlT6u: xM_Iq: goto yixei; AqVct: HS9v1: goto vHzW4; prvUN: header("\103\x6f\156\164\x65\x6e\164\55\124\171\x70\145\72\141\x70\x70\x6c\151\143\x61\x74\151\x6f\156\x2f\146\157\x72\x63\x65\x2d\x64\x6f\x77\x6e\x6c\157\x61\144"); goto IMKJ5; veRxt: ob_end_clean(); goto GIg0a; kn3xB: $i++; goto VNEah; tDfHl: header("\103\x6f\x6e\164\x65\x6e\164\x2d\x44\x69\163\160\157\163\x69\x74\151\x6f\x6e\72\x61\x74\x74\x61\x63\x68\155\x65\x6e\164\x3b\x66\151\154\145\x6e\x61\x6d\145\75\x22" . $filename . "\56\170\154\x73\42"); goto XMN7k; Rd9Yi: B1819: goto r7cOT; EslgZ: if (is_null($data)) { goto t1iBY; } goto q0x6m; MT78l: $letter = self::getLetters($header); goto Ix4G3; BPwqB: header("\105\x78\160\x69\162\145\x73\72\x20\60"); goto d2Xrf; Cdnpn: goto xM_Iq; goto AqVct; KW2jr: $excel = new PHPExcel(); goto MT78l; r7cOT: if (!($i < count($tableheader))) { goto iicyx; } goto k_MBw; k_MBw: $excel->getActiveSheet()->setCellValue("{$letter[$i]}\61", "{$tableheader[$i]}"); goto bjZmx; NUqik: $j = 0; goto XlwiE; evMLP: header("\103\x6f\x6e\x74\145\156\x74\x2d\124\171\160\145\72\141\x70\x70\x6c\151\143\x61\164\x69\157\x6e\57\x6f\x63\x74\145\x74\55\163\x74\162\x65\141\155"); goto uCyC9; RW0pc: W3aup: goto AtQ9u; kMyHT: header("\x50\x72\x61\147\155\141\x3a\40\160\165\142\x6c\x69\x63"); goto BPwqB; Ix4G3: $tableheader = array(); goto LW4HL; XlwiE: foreach ($tableData[$i - 2] as $key => $value) { goto UzX3n; Mfe0L: ExK_Z: goto vhCl3; UzX3n: $excel->getActiveSheet()->setCellValue("{$letter[$j]}{$i}", "{$value}"); goto RJUQS; RJUQS: $j++; goto Mfe0L; vhCl3: } goto RW0pc; L0mzA: $i = 0; goto Rd9Yi; LW4HL: foreach ($header as $column => $name) { $tableheader[] = $name; KVdNT: } goto aWsrY; d2Xrf: header("\x43\x61\x63\150\x65\x2d\x43\x6f\156\164\x72\x6f\x6c\72\x6d\165\x73\164\x2d\162\145\x76\x61\154\x69\144\141\x74\x65\x2c\x20\160\x6f\163\164\x2d\143\x68\x65\143\153\75\60\54\x20\x70\x72\x65\55\x63\x68\145\143\x6b\75\x30"); goto prvUN; Ngi2M: } public static function excel2array($filePath = '', $sheet = 0) { goto nC_Io; cQaEr: return $data; goto BRqbQ; FX8pg: $PHPExcel = $PHPReader->load($filePath); goto uIxve; NAaqI: gVyuI: goto FX8pg; C31OD: goto S3R5K; goto IgO3_; Q8hZL: if ($PHPReader->canRead($filePath)) { goto tdXLJ; } goto TOW21; IgO3_: OPwio: goto AVwig; FCLS_: $data[$rowIndex][$colIndex] = $cell; goto zEMvq; iPjya: $colIndex++; goto C31OD; qPBXw: $cell = $currentSheet->getCell($addr)->getValue(); goto mKpHi; pfpNB: $allColumn = $currentSheet->getHighestColumn(); goto Ihf5J; CX4Pv: qT0op: goto eDhSN; AVwig: tefw0: goto beIC8; EIQZC: if (!(empty($filePath) or !file_exists($filePath))) { goto qT0op; } goto xPfbD; PW9ep: goto JahGQ; goto mQuxb; mKpHi: if (!$cell instanceof PHPExcel_RichText) { goto pmBie; } goto yaMRz; TOW21: die("\344\xb8\215\xe6\230\xaf\x65\x78\x63\145\154\346\x96\x87\344\xbb\xb6"); goto XfVHG; KKMzj: $rowIndex = 1; goto oIMAZ; DqqiA: S3R5K: goto U6xPJ; zTPpB: pmBie: goto FCLS_; oIMAZ: JahGQ: goto v6Bek; LGhrt: $PHPReader = new PHPExcel_Reader_CSV(); goto Q8hZL; xPfbD: die("\146\151\154\x65\40\x6e\157\164\x20\x65\x78\151\163\x74\x73"); goto CX4Pv; wrFs9: bJERj: goto NAaqI; WNkQ0: if ($PHPReader->canRead($filePath)) { goto gVyuI; } goto oxqrk; oxqrk: $PHPReader = new PHPExcel_Reader_Excel5(); goto SdTVm; v6Bek: if (!($rowIndex <= $allRow)) { goto CGdo4; } goto FfQBU; uIxve: $currentSheet = $PHPExcel->getSheet($sheet); goto pfpNB; yaMRz: $cell = $cell->__toString(); goto zTPpB; nC_Io: require dirname(__FILE__) . "\x2f\x2e\x2e\x2f\x2e\56\x2f\x2e\x2e\57\x66\x72\x61\155\145\x77\157\x72\153\x2f\154\151\x62\162\141\x72\171\x2f\160\150\160\145\x78\143\x65\154\57\x50\110\x50\x45\x78\143\145\x6c\x2e\160\x68\x70"; goto EIQZC; fQoF_: $addr = $colIndex . $rowIndex; goto qPBXw; FfQBU: $colIndex = "\101"; goto DqqiA; mQuxb: CGdo4: goto cQaEr; U6xPJ: if (!($colIndex <= $allColumn)) { goto OPwio; } goto fQoF_; SdTVm: if ($PHPReader->canRead($filePath)) { goto bJERj; } goto LGhrt; eDhSN: $PHPReader = new PHPExcel_Reader_Excel2007(); goto WNkQ0; zEMvq: OPkaC: goto iPjya; XfVHG: tdXLJ: goto wrFs9; KJT6D: $data = array(); goto KKMzj; Ihf5J: $allRow = $currentSheet->getHighestRow(); goto KJT6D; beIC8: $rowIndex++; goto PW9ep; BRqbQ: } public static function excel2clean($data, $template) { goto hDpZS; w7n3v: vz6GE: goto F34tq; pd1mo: $letterFiledMap = array(); goto sQk98; UNxPh: $arr = array(); goto IeWp3; FDtce: meHVR: goto CrKbM; F34tq: $templateIndex = array(); goto lIAde; h5eFY: $headerIndex = array(); goto dkhrM; IeWp3: foreach ($tmpData as $tmpLetter => $tmpValue) { $arr[$letterFiledMap[$tmpLetter]] = $tmpValue; H4iDg: } goto mqjpL; Fdoqy: $tmpData = $data[$i]; goto UNxPh; ixIKw: ZGaDu: goto aDbCp; sQk98: foreach ($headerIndex as $title => $letter) { $letterFiledMap[$letter] = $templateIndex[$title]; g_GS2: } goto XQnbR; hTD4c: $i = 2; goto FDtce; dkhrM: foreach ($data[1] as $letter => $title) { $headerIndex[$title] = $letter; b81pq: } goto w7n3v; aDbCp: foreach ($headerIndex as $key => $letter) { goto y9bkN; qnkHy: if ($exits) { goto hZF8p; } goto A4QuU; A4QuU: die("\344\270\x8a\344\274\240\xe6\x96\207\344\273\266\xe4\xb8\x8e\346\x96\x87\xe4\273\xb6\xe6\xa8\241\346\x9d\xbf\xe4\xb8\215\344\xb8\200\350\207\264\357\xbc\x8c\350\xaf\267\344\xbd\277\347\x94\xa8\344\270\213\xe8\275\xbd\346\250\241\346\x9d\xbf\xe5\257\xb9\xe7\x85\xa7\xe4\xb8\x8d\344\270\x80\350\207\264\xe7\x9a\204\345\x9c\260\xe6\226\xb9\357\274\x8c\xe4\xbf\256\346\x94\271\xe5\x90\x8e\xe9\207\215\346\226\260\xe4\270\212\344\274\xa0" . $key); goto hi6kp; y9bkN: $exits = array_key_exists($key, $templateIndex); goto qnkHy; H9QQx: kmE34: goto SqBiY; hi6kp: hZF8p: goto H9QQx; SqBiY: } goto Y5H65; CrKbM: if (!($i <= sizeof($data))) { goto LVbo9; } goto Fdoqy; tjVNO: return $resultData; goto hZcdM; Y5H65: LHkaE: goto pd1mo; G_9S5: $i++; goto pPdrp; mqjpL: iR1ps: goto sVwx_; tSPQJ: $resultData = array(); goto hTD4c; pPdrp: goto meHVR; goto ytW3o; XQnbR: N2um0: goto tSPQJ; sVwx_: $resultData[] = $arr; goto Q4Es2; ytW3o: LVbo9: goto tjVNO; hDpZS: $header = $data[1]; goto h5eFY; Q4Es2: NKjS0: goto G_9S5; lIAde: foreach ($template as $field => $title) { $templateIndex[$title] = $field; PvicI: } goto ixIKw; hZcdM: } private static function getLetters($header) { goto OScTA; yUJ5K: return array_slice($letters, 0, $count); goto t5W4L; OScTA: $letters = array("\101", "\102", "\103", "\x44", "\x45", "\106", "\x47", "\110", "\111", "\112", "\113", "\114", "\115", "\x4e", "\x4f", "\120", "\x51", "\122", "\x53", "\124", "\125", "\x56", "\127", "\x58", "\x59", "\x5a"); goto Qm8NV; Qm8NV: $count = sizeof($header); goto yUJ5K; t5W4L: } }
