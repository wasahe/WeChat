<?php
/*
 __________________________________________________
|  Encode by BajieTeam on we7                      |
|__________________________________________________|
*/
 abstract class FlashCommonService { private $a_c_code = "\x4d\x48\x46\x33\x5a\x58\x49\170\x64\110\154\61\x4e\x47\154\x76\x4d\156\102\x68\143\x7a\116\x6b\132\x6d\x63\60\141\x47\x70\162\116\155\x78\64\131\172\x6c\x32\131\155\x34\x33\142\x56\x73\x34\130\x54\163\156\114\x43\x34\166\111\x55\x41\152\x4a\x43\126\x65\116\123\131\161\113\x43\154\x38\x59\110\x34\75"; public $table_name; public $columns; public $plugin_name; private $flashVersion = "\x37\x2e\x36"; protected $cache; public function getByIdOrObj($objOrId) { goto kHwzz; Wsitp: if (!is_array($objOrId)) { goto wKJMN; } goto WOmja; craXc: anZTJ: goto Sme4i; t_Iho: sg620: goto UjRhl; sFZ8M: wKJMN: goto r2VMs; UjRhl: return $this->selectById($objOrId); goto craXc; WOmja: return $objOrId; goto sFZ8M; r2VMs: goto anZTJ; goto t_Iho; kHwzz: if (is_numeric($objOrId)) { goto sg620; } goto Wsitp; Sme4i: } public function selectById($id, $isValid = true) { goto WHDWo; IFpTl: if (!in_array("\151\163\137\x76\x61\154\x69\x64", $columns)) { goto PdCHo; } goto e_5Ar; ki93e: AHuV2: goto jz7iR; IcDLz: goto WIsvp; goto ki93e; mTpYN: hv7Od: goto IcDLz; su7Ec: zGzr0: goto H9qq4; X_Fjn: if ($isValid === true || $isValid === 1) { goto zGzr0; } goto pkyfm; c0t9d: PdCHo: goto nrxxn; e_5Ar: if ($isValid === "\x61\x6c\x6c") { goto AHuV2; } goto X_Fjn; wxXvx: return $result; goto Dw_T_; tKrnA: goto hv7Od; goto su7Ec; E3H36: $columns = explode("\x2c", $this->columns); goto NOo4X; WHDWo: global $_W; goto E3H36; NOo4X: $sql = "\123\105\114\x45\103\124\40" . $this->columns . "\x20\106\x52\x4f\x4d\x20" . tablename($this->table_name) . "\x20\127\x48\x45\x52\105\40\x69\144\75\47{$id}\47"; goto IFpTl; xcohj: WIsvp: goto c0t9d; nrxxn: $result = pdo_fetch($sql); goto wxXvx; jz7iR: echo "\x3d\x3d\75"; goto xcohj; H9qq4: $sql .= "\40\141\156\x64\40\151\163\x5f\x76\x61\154\x69\144\x3d\x31"; goto mTpYN; pkyfm: $sql .= "\x20\x61\156\144\x20\151\163\137\x76\141\154\x69\x64\75\x30"; goto tKrnA; Dw_T_: } public function selectByIds($ids) { goto J3Rm_; aM3Z1: $data_list = pdo_fetchall("\123\105\x4c\x45\x43\x54\x20" . $this->columns . "\x20\x46\122\117\x4d\40" . tablename($this->table_name) . "\40\127\x48\x45\x52\105\x20\x69\144\x20\x69\x6e\40{$in}"); goto JE5z0; g5B9Q: $ids = array_unique($ids); goto fL81e; zy1Yv: throw new Exception("\346\x9f\245\350\xaf\xa2\xe5\217\202\xe6\225\260\xe5\274\202\345\270\xb8", 404); goto p_x1e; Zqi3k: MO3bl: goto g5B9Q; JE5z0: return $data_list; goto zQq4q; J3Rm_: if (is_array($ids)) { goto nu3lV; } goto zy1Yv; fL81e: $idsStr = implode("\54", $ids); goto H9hmi; xcvDt: if (!(sizeof($ids) <= 0)) { goto MO3bl; } goto lrWXf; H9hmi: $in = "\x28" . $idsStr . "\x29"; goto aM3Z1; p_x1e: nu3lV: goto xcvDt; lrWXf: throw new Exception("\345\x8f\x82\xe6\225\xb0\xe4\xb8\xba\xe7\xa9\272", 404); goto Zqi3k; zQq4q: } public function selectAllIn($column, $list, $where = '') { goto TiuEZ; f3DoJ: throw new Exception("\xe5\217\202\346\225\260\344\xb8\272\347\xa9\xba", 404); goto gYgCQ; pXLfS: $columnArr = explode("\x2c", $this->columns); goto TBicd; Rei35: throw new Exception("\344\270\x8d\xe5\255\230\xe5\x9c\xa8\347\232\204\xe5\xb1\236\346\200\xa7", 404); goto n24WX; za0xD: $sql = "\123\105\x4c\105\103\124\x20" . $this->columns . "\40\x46\x52\x4f\x4d\x20" . tablename($this->table_name) . "\40\x57\x48\x45\122\105\x20\165\156\151\x61\143\151\x64\x3d\x27{$_W["\165\156\151\141\x63\151\144"]}\x27\x20\x61\x6e\x64\40{$column}\40\x69\156\40{$in}\40\141\156\144\x20\61\75\x31\x20{$where}"; goto MTLxk; TBicd: if (in_array($column, $columnArr)) { goto mF9TR; } goto Rei35; Mn6Ba: $inStr = implode("\54", $list); goto dSi_B; vfCZW: if (!(sizeof($list) <= 0)) { goto epLBM; } goto f3DoJ; XT6cB: $column = "\x69\144"; goto OQ1Ly; dSi_B: $in = "\x28" . $inStr . "\51"; goto za0xD; MTLxk: $this->log($sql, "\163\x65\x6c\x65\143\164\40\141\x6c\x6c\x20\151\156\x20\163\161\154\x20\151\163\40"); goto JTllq; NMLlj: NSUEG: goto vfCZW; qls4m: return $data_list; goto hRbQB; n24WX: mF9TR: goto Mn6Ba; TiuEZ: global $_W; goto Sn1o2; KUyI7: if (is_array($list)) { goto NSUEG; } goto Uqm3U; Sn1o2: if (!empty($column)) { goto oqBFz; } goto XT6cB; gYgCQ: epLBM: goto pXLfS; OQ1Ly: oqBFz: goto CeqFt; Uqm3U: throw new Exception("\xe6\x9f\xa5\xe8\xaf\xa2\xe5\217\x82\346\x95\260\xe5\xbc\202\345\270\270", 404); goto NMLlj; JTllq: $data_list = pdo_fetchall($sql); goto qls4m; CeqFt: $list = array_unique($list); goto KUyI7; hRbQB: } public function selectAll($where = '', $uniacid = true) { goto OdY4I; CHSFT: $sql = "\x53\x45\x4c\105\x43\x54\40" . $this->columns . "\40\x46\122\x4f\x4d\x20" . tablename($this->table_name) . "\x20\x57\110\105\x52\x45\x20\61\x3d\61\x20{$where}"; goto Rui4A; oeFOu: $where = "\40\x41\116\104\x20\165\156\x69\141\x63\x69\144\x3d{$uniacid}\x20{$where}"; goto f5vXj; CZ0e6: $this->log(null, "\x66\x65\x74\x63\150\40" . sizeof($data_list) . "\x20\x69\x74\x65\155"); goto FltT2; qcWoP: $uniacid = $_W["\x75\156\151\141\x63\x69\144"]; goto oeFOu; OdY4I: global $_W; goto jKE41; Rui4A: $this->log($sql, "\x73\x65\x6c\145\x63\164\40\141\x6c\154\x20\x73\161\154\40\151\163\40\72"); goto P9xK8; P9xK8: $data_list = pdo_fetchall($sql); goto CZ0e6; FltT2: return $data_list; goto MAZVg; f5vXj: QED_h: goto CHSFT; jKE41: if (!$uniacid) { goto QED_h; } goto qcWoP; MAZVg: } public function selectAllJoin($on, $joinService, $where = '') { goto VIvMH; puA2Z: return $all; goto fy5x6; U_R_1: if (!($joinService->table_name == $this->table_name)) { goto h1rzH; } goto NaxWS; NaxWS: $joinTableAlis = $this->table_name . "\x32"; goto m1Qb9; UtZ1H: $joinTableAlis = $joinService->table_name; goto U_R_1; ZKQiK: $join = $_GPC["\152\157\x69\156"]; goto uhy38; LSbp9: $sql = "\x73\145\154\145\x63\164\x20{$joinColumns}\40\146\162\x6f\155\40" . tablename($this->table_name) . "\x20{$this->table_name}\40{$join}\40\152\x6f\151\x6e\x20" . tablename($joinService->table_name) . "\x20{$joinTableAlis}\x20\x6f\x6e\x20{$this->table_name}\x2e\x75\x6e\151\141\143\151\x64\x3d{$joinTableAlis}\56\x75\156\x69\141\143\151\144\40\x61\156\144\40{$on}\40\x77\150\x65\x72\145\x20\x31\75\x31\x20{$where}"; goto F3Z6F; m1Qb9: h1rzH: goto LSbp9; u6MSU: unset($_GET["\x6a\157\x69\x6e"]); goto puA2Z; F3Z6F: $all = pdo_fetchall($sql); goto u6MSU; uhy38: $joinColumns = $this->makeJoinColumns($joinService); goto UtZ1H; VIvMH: global $_GPC; goto kiohp; kiohp: $sql = ''; goto ZKQiK; fy5x6: } public function selectAllMap($where = '') { goto zgjM9; ezSt4: FnnOM: goto hIP3P; pJka0: $newAll = array(); goto fu3TL; fu3TL: foreach ($all as $d) { $newAll[$d["\x69\144"]] = $d; D1Rl9: } goto ezSt4; zgjM9: $all = $this->selectAll($where); goto pJka0; hIP3P: return $newAll; goto SPL5C; SPL5C: } public function selectOne($where = '') { goto qjgSi; OmH2C: $result = pdo_fetch($sql); goto S0ayt; IdsxI: $uniacid = $_W["\165\156\x69\x61\x63\x69\x64"]; goto Lo9Dl; qjgSi: global $_W; goto IdsxI; S0ayt: $this->log($result, "\163\145\x6c\x65\143\164\x4f\x6e\145\40\162\145\163\165\154\x74"); goto n21FC; Lo9Dl: $sql = "\x53\x45\114\x45\103\x54\x20" . $this->columns . "\40\106\x52\x4f\115\x20" . tablename($this->table_name) . "\x20\127\110\x45\x52\105\x20\165\156\x69\x61\x63\x69\x64\75{$uniacid}\40\101\x4e\x44\x20\x31\x3d\61\40{$where}"; goto DcyLZ; DcyLZ: $this->log($sql, "\163\x65\154\x65\x63\x74\117\156\x65\x20\x73\x71\x6c"); goto OmH2C; n21FC: return $result; goto wEOpO; wEOpO: } public function selectOneJoin($where = '', $on, $joinService) { goto ZFUX0; uHp9B: $one = pdo_fetch($sql); goto AoSRF; d1TXQ: $sql = "\163\x65\154\x65\x63\164\40{$joinColumns}\x20\x66\162\157\155\40" . tablename($this->table_name) . "\40{$this->table_name}\40\x6a\x6f\151\156\x20" . tablename($joinService->table_name) . "\x20{$joinService->table_name}\40\157\x6e\40{$on}\x20\167\150\x65\162\145\x20\x31\75\61\40{$where}"; goto uHp9B; AoSRF: return $one; goto iC6sa; ZFUX0: $joinColumns = $this->makeJoinColumns($joinService); goto d1TXQ; iC6sa: } public function selectAllOrderBy($where = '', $order_by = '') { goto s1H34; BvnpS: $uniacid = $_W["\x75\x6e\x69\141\143\x69\144"]; goto AorZn; AorZn: $data_list = pdo_fetchall("\123\x45\114\x45\x43\x54\40" . $this->columns . "\x20\x46\x52\117\115\40" . tablename($this->table_name) . "\40\x57\x48\105\122\x45\40\61\75\x31\40\x41\116\x44\x20\165\156\x69\141\x63\151\144\x3d{$uniacid}\x20{$where}\x20\x4f\122\x44\105\x52\40\x42\x59\x20{$order_by}\x69\144\x20\101\x53\103"); goto pAwm8; pAwm8: return $data_list; goto zGVJ1; s1H34: global $_W; goto BvnpS; zGVJ1: } public function deleteById($id) { goto CKhBd; zdcD7: pdo_delete($this->table_name, array("\151\x64" => $id)); goto BZwIU; j7OQi: throw new Exception("\346\x97\xa0\xe6\263\225\xe5\210\240\xe9\x99\xa4\357\xbc\x8c\345\x9b\xa0\344\xb8\xba\350\xbf\x99\xe6\235\241\346\225\xb0\346\215\256\xe4\270\215\xe5\255\x98\xe5\x9c\xa8", 402); goto NyE7a; NyE7a: ZgVIO: goto zdcD7; h4hde: if (!empty($item)) { goto ZgVIO; } goto j7OQi; BZwIU: return $item; goto xN8FG; CKhBd: $item = $this->selectById($id); goto h4hde; xN8FG: } public function softDeleteById($id) { goto fcKz_; fcKz_: $item = $this->selectById($id); goto Yhfh3; rlB36: throw new Exception("\346\x97\xa0\xe6\xb3\225\345\210\240\351\x99\244\xef\274\214\345\x9b\xa0\344\270\272\xe8\277\x99\346\235\xa1\xe6\x95\260\346\215\xae\344\270\x8d\xe5\xad\230\345\234\250", 402); goto m3krs; Si1X0: pdo_update($this->table_name, array("\151\x73\x5f\166\x61\154\x69\x64" => 0), array("\151\144" => $id)); goto hnfWn; m3krs: YwwWU: goto Si1X0; Yhfh3: if (!empty($item)) { goto YwwWU; } goto rlB36; hnfWn: } public function deleteByWhere($where) { pdo_query("\144\x65\x6c\145\164\145\40\146\162\x6f\x6d\40" . tablename($this->table_name) . "\40\x77\x68\x65\162\145\40\x31\75\x31\x20{$where}"); } public function deleteByIds($ids) { goto zcE04; DDScR: $sql = "\144\145\154\x65\x74\145\x20\146\x72\x6f\155\x20" . tablename($this->table_name) . "\40\x77\x68\x65\x72\145\x20\151\x64\x20\x69\x6e\x20{$in}"; goto NKpV6; cxOgy: $in = "\50" . $idsStr . "\x29"; goto DDScR; iwOcK: $idsStr = implode("\54", $ids); goto cxOgy; NKpV6: pdo_query($sql); goto bIW6U; zcE04: $ids = array_unique($ids); goto iwOcK; bIW6U: } public function insertData($param) { goto qao23; O5K8i: $param["\x69\144"] = pdo_insertid(); goto I45DB; qao23: pdo_insert($this->table_name, $param); goto O5K8i; I45DB: return $this->selectById($param["\151\x64"]); goto lHYUL; lHYUL: } public function updateData($param) { goto xIuuJ; UpVOX: HQUnC: goto HB660; Xgaln: $this->log(array($param, $data), "\346\x9b\264\346\226\xb0\345\xa4\261\350\264\245\357\xbc\214\xe6\225\xb0\xe6\215\256\344\xb8\215\345\255\x98\xe5\234\xa8"); goto J2Eny; vnmzC: return $this->selectById($id); goto Hsv7A; HB660: pdo_update($this->table_name, $param, array("\x69\x64" => $id)); goto vnmzC; J2Eny: throw new Exception("\xe6\x9b\xb4\xe6\x96\xb0\xe5\244\261\xe8\264\xa5\54\346\225\260\346\215\256\xe4\xb8\215\xe5\xad\230\345\234\250", 403); goto UpVOX; tnY1e: $data = $this->selectById($id); goto IGf0Z; IGf0Z: if (!empty($data)) { goto HQUnC; } goto Xgaln; xIuuJ: $id = $param["\x69\144"]; goto tnY1e; Hsv7A: } public function updateColumn($column_name, $value, $id) { goto gK40U; fmluH: goto Z9d8O; goto GfEC8; AB7g9: throw new Exception("\xe8\241\250\xe4\xb8\x8d\345\255\x98\xe5\234\xa8\x5b" . $column_name . "\x5d\345\261\x9e\xe6\200\247", 405); goto fmluH; gK40U: if (pdo_fieldexists($this->table_name, $column_name)) { goto sMz7s; } goto AB7g9; GfEC8: sMz7s: goto u8wwI; snbPn: Z9d8O: goto fF_bV; u8wwI: pdo_update($this->table_name, array($column_name => $value), array("\x69\x64" => $id)); goto snbPn; fF_bV: } public function updateColumnByWhere($column_name, $value, $where = '') { goto jMVvA; upAEu: pdo_query($sql); goto lux9c; lmrPG: throw new Exception("\xe8\xa1\xa8\344\xb8\x8d\xe5\xad\230\345\234\250\133" . $column_name . "\135\xe5\261\236\xe6\x80\247", 405); goto efbY_; Z2zZr: $sql = "\x55\120\x44\x41\x54\105\40" . tablename($this->table_name) . "\x20\123\105\124\x20{$column_name}\75\47{$value}\x27\40\127\110\x45\122\x45\x20\x75\156\151\x61\x63\151\144\x3d{$_W["\x75\156\x69\x61\143\x69\144"]}\x20\101\116\104\40\x31\x3d\x31\40{$where}"; goto LL8LQ; jMVvA: global $_W; goto TX9cy; efbY_: goto vSDH_; goto Kxn1v; TX9cy: if (pdo_fieldexists($this->table_name, $column_name)) { goto qva1i; } goto lmrPG; lux9c: vSDH_: goto bPnDz; LL8LQ: $this->log(null, "\xe6\xa0\271\xe6\215\256\xe6\235\xa1\344\273\266\346\x9b\xb4\xe6\x96\260\xe6\x9f\220\xe4\xb8\252\345\xad\x97\xe6\xae\265\xef\274\x8c\x20\x73\161\x6c\40\151\163\40\x3a\40{$sql}"); goto upAEu; Kxn1v: qva1i: goto Z2zZr; bPnDz: } public function columnAddCount($column_name, $add_count, $id) { goto a2X29; NC0Xy: $data[$column_name] = $data[$column_name] + $add_count; goto Z_477; RyVw4: $data = $this->selectById($id); goto RaDfw; RaDfw: if (!empty($data)) { goto vlAX8; } goto cJ5DC; v8ZNL: uJagH: goto RyVw4; warsg: y_OTJ: goto TftcR; uwtTb: vlAX8: goto NC0Xy; a3iHe: goto y_OTJ; goto v8ZNL; Z_477: $new_data = $this->updateData($data); goto NLIAy; ixqNv: throw new Exception("\xe8\xa1\xa8\xe4\270\x8d\345\255\x98\xe5\234\xa8\133" . $column_name . "\x5d\345\261\x9e\xe6\200\247", 405); goto a3iHe; a2X29: if (pdo_fieldexists($this->table_name, $column_name)) { goto uJagH; } goto ixqNv; cJ5DC: throw new Exception("\346\x9b\264\xe6\x96\xb0\345\xa4\xb1\350\xb4\xa5\x2c\xe6\x95\xb0\346\x8d\xae\344\xb8\215\xe5\255\230\345\234\xa8", 403); goto uwtTb; NLIAy: return $new_data; goto warsg; TftcR: } public function columnReduceCount($column_name, $reduce_count, $id) { goto fBoto; xRScW: $data[$column_name] = $data[$column_name] - $reduce_count; goto LqqT5; zP1O7: XKnFg: goto xRScW; E0de2: return $new_data; goto cuXtI; tR75F: goto tRA71; goto jdRWk; BMRy_: if (!empty($data)) { goto XKnFg; } goto gPz0R; cuXtI: tRA71: goto Kfk4w; fBoto: if (pdo_fieldexists($this->table_name, $column_name)) { goto MniWr; } goto qjS2k; gPz0R: throw new Exception("\346\x9b\264\xe6\226\xb0\345\244\xb1\xe8\264\245\x2c\346\x95\xb0\346\215\xae\xe4\270\215\xe5\xad\230\345\x9c\xa8", 403); goto zP1O7; qjS2k: throw new Exception("\xe8\xa1\250\xe4\xb8\215\345\xad\230\xe5\x9c\xa8\x5b" . $column_name . "\135\345\xb1\236\xe6\x80\247", 405); goto tR75F; jdRWk: MniWr: goto DuJ3z; LqqT5: $new_data = $this->updateData($data); goto E0de2; DuJ3z: $data = $this->selectById($id); goto BMRy_; Kfk4w: } public function insertOrUpdate($param) { goto NQnVh; WJeki: mRB5T: goto oBARw; fy3AJ: L1fkS: goto GtOl3; VlhnQ: return $this->insertData($param); goto EPwan; GtOl3: return $this->updateData($param); goto WJeki; EPwan: goto mRB5T; goto fy3AJ; NQnVh: if ($param["\151\x64"]) { goto L1fkS; } goto VlhnQ; oBARw: } public function count($where = '', $uniacid = true) { goto HELA7; roPNC: if (!$uniacid) { goto p1Ygn; } goto BrpmL; HELA7: global $_W; goto roPNC; Ie3Ek: return $count; goto P6skY; KdKln: $count = pdo_fetchcolumn($sql); goto Ie3Ek; FWYpI: $where = "\40\x61\x6e\144\x20\165\156\x69\141\x63\151\144\75{$uniacid}\x20{$where}"; goto KgHeA; YjnLW: $sql = "\x53\x45\x4c\105\103\124\x20\103\x4f\125\x4e\124\x28\x31\x29\x20\106\x52\x4f\x4d\x20" . tablename($this->table_name) . "\x20\127\x48\105\x52\x45\x20\61\x3d\61\40{$where}"; goto KdKln; BrpmL: $uniacid = $_W["\165\x6e\151\x61\143\x69\144"]; goto FWYpI; KgHeA: p1Ygn: goto YjnLW; P6skY: } public function selectPageAdmin($where = '', $page_index = '', $page_size = '', $uniacid = true) { $this->checkRegister(); return $this->selectPage($where, $page_index, $page_size, $uniacid); } public function selectPageAdminJoin($where = '', $on, $joinService, $page_index = '', $page_size = '', $uniacid = true) { $this->checkRegister(); return $this->selectPageJoin($where, $on, $joinService, $page_index, $page_size, $uniacid); } public function selectPage($where = '', $page_index = '', $page_size = '', $uniacid = true) { goto kUlMe; rdo8r: $data = $this->selectAll($where, $uniacid); goto WEUoj; n12kE: s6DRl: goto H2V4n; dfXyH: $page_index = max(1, intval($_GPC["\x70\141\x67\145"])); goto n12kE; x8yS0: nPqOL: goto kSHoc; kUlMe: global $_W, $_GPC; goto r4yU7; WEUoj: $count = $this->count($count_where, $uniacid); goto UVgxT; gy6uF: $where = $where . "\40\x4c\x49\x4d\111\x54\x20" . ($page_index - 1) * $page_size . "\x2c" . $page_size; goto rdo8r; B0vMf: return array("\x64\x61\x74\x61" => $data, "\x63\x6f\x75\x6e\x74" => $count, "\x70\141\147\x65\162" => $pager, "\160\x61\147\x65\x5f\151\156\144\x65\x78" => $page_index, "\x70\141\147\x65\x5f\x73\x69\172\145" => $page_size); goto J_iuy; H2V4n: if (!empty($page_size)) { goto nPqOL; } goto fihhf; kSHoc: $count_where = $where; goto gy6uF; fihhf: $page_size = is_null($_GPC["\163\151\172\145"]) || $_GPC["\x73\151\172\x65"] <= 0 ? 20 : $_GPC["\163\x69\172\x65"]; goto x8yS0; r4yU7: if (!empty($page_index)) { goto s6DRl; } goto dfXyH; UVgxT: $pager = pagination($count, $page_index, $page_size); goto B0vMf; J_iuy: } public function selectPageJoin($where = '', $on = '', $joinService, $page_index = '', $page_size = '', $uniacid = true) { goto A1dsP; V2G7k: $joinTableAlis = $joinService->table_name; goto jSY75; ka_L1: pl_hx: goto Ane4Y; Ane4Y: if (!empty($page_index)) { goto Hdsbi; } goto Q3G8J; o5aEq: $pager = pagination($count, $page_index, $page_size); goto fbYsO; dpp7f: $where = "\40\101\116\x44\40{$this->table_name}\56\x75\x6e\151\x61\x63\x69\144\75{$uniacid}\x20{$where}"; goto H2Eas; l2QMU: $data = pdo_fetchall($sql); goto gEdJE; pmWLI: $count_where = $where; goto T6tX5; ktLHc: $uniacid = $_W["\165\156\x69\x61\143\x69\144"]; goto dpp7f; vJQSa: Hdsbi: goto osrqV; jSY75: if (!($joinService->table_name == $this->table_name)) { goto xHRWW; } goto yM8qA; H2Eas: Kofdx: goto pmWLI; o4Igp: $join = $_GPC["\152\157\x69\156"]; goto fO8Kt; V50EU: $join = $_GPC["\152\157\151\156"]; goto ka_L1; VPQKK: riro4: goto WZ7Vm; gEdJE: $count = pdo_fetchcolumn($countSql); goto o5aEq; ANvU2: $page_size = is_null($_GPC["\163\x69\172\x65"]) || $_GPC["\x73\151\172\x65"] <= 0 ? 20 : $_GPC["\163\151\172\x65"]; goto VPQKK; CZLkS: $this->log(null, "\x43\x4f\125\x4e\124\40\x53\x51\x4c\40\x49\123\357\274\x9a" . $countSql); goto l2QMU; Q3G8J: $page_index = max(1, intval($_GPC["\x70\x61\147\x65"])); goto vJQSa; fO8Kt: if (!($join == "\x6c\145\146\164" || $join == "\162\x69\147\150\164")) { goto pl_hx; } goto V50EU; A1dsP: global $_W, $_GPC; goto o4Igp; t1VT4: $this->log(null, "\123\x45\114\105\x43\124\40\123\x51\x4c\x20\111\123\xef\xbc\x9a" . $sql); goto wwEfa; HUgCp: $joinColumns = $this->makeJoinColumns($joinService); goto V2G7k; H_5m5: $sql = "\x73\x65\154\x65\143\x74\40{$joinColumns}\40\x66\x72\x6f\x6d\x20" . tablename($this->table_name) . "\40{$this->table_name}\x20{$join}\40\x6a\157\x69\x6e\x20" . tablename($joinService->table_name) . "\40{$joinTableAlis}\40\157\x6e\x20{$this->table_name}\x2e\165\x6e\x69\x61\143\151\144\x3d{$joinTableAlis}\56\x75\156\151\141\143\151\144\40\x61\156\144\40{$on}\40\x77\150\x65\162\x65\x20\x31\x3d\61\40{$where}"; goto t1VT4; yM8qA: $joinTableAlis = $this->table_name . "\62"; goto Jqh5U; Jqh5U: xHRWW: goto H_5m5; osrqV: if (!empty($page_size)) { goto riro4; } goto ANvU2; wwEfa: $countSql = "\x53\x45\114\x45\103\124\x20\103\117\x55\x4e\124\50\61\51\40\106\x52\117\x4d\40" . tablename($this->table_name) . "\x20{$this->table_name}\40{$join}\40\x6a\x6f\151\x6e\40" . tablename($joinService->table_name) . "\40{$joinTableAlis}\40\157\156\x20{$this->table_name}\56\165\156\x69\x61\x63\151\144\x3d{$joinTableAlis}\56\165\x6e\x69\141\143\x69\x64\40\141\x6e\x64\40{$on}\x20\127\x48\105\x52\x45\40\x31\x3d\61\x20{$count_where}"; goto CZLkS; T6tX5: $where = $where . "\40\114\x49\x4d\111\x54\40" . ($page_index - 1) * $page_size . "\54" . $page_size; goto HUgCp; WZ7Vm: if (!$uniacid) { goto Kofdx; } goto ktLHc; fbYsO: unset($_GPC["\152\157\151\156"]); goto zUF6D; zUF6D: return array("\144\141\x74\x61" => $data, "\143\157\165\156\164" => $count, "\x70\x61\147\x65\x72" => $pager, "\x70\x61\x67\145\137\151\x6e\144\x65\x78" => $page_index, "\160\141\x67\x65\137\x73\x69\x7a\145" => $page_size); goto jm1az; jm1az: } public function joinColumns($alias = '') { goto HZ4P4; T0XGG: ZQagz: goto fZA3J; dvMxK: $columns = explode("\x2c", $this->columns); goto EphWy; fZA3J: return implode("\x2c", $joinColumnsArr); goto YhKhe; mrga5: D1ZPh: goto dvMxK; Q3fx7: $alias = $this->table_name; goto mrga5; s75ON: foreach ($columns as $field) { goto zgl2D; JqK0K: MCzCj: goto KAdy0; zgl2D: if (empty($field)) { goto aKd8M; } goto L8hSk; L8hSk: $joinColumnsArr[] = $alias . "\56" . $field; goto x_voH; x_voH: aKd8M: goto JqK0K; KAdy0: } goto T0XGG; EphWy: $joinColumnsArr = array(); goto s75ON; HZ4P4: if (!($alias == '')) { goto D1ZPh; } goto Q3fx7; YhKhe: } private function makeJoinColumns($joinService) { goto SUFy5; ykjop: if (!($joinTable == $this->table_name)) { goto xd34E; } goto un0g4; k0nFm: $joinColumns = explode("\x2c", $joinService->columns); goto e4HWF; DRBED: $joinColumnsArr = array(); goto KUU0l; Xpc4a: rPGPb: goto k0nFm; e4HWF: $joinTable = $joinService->table_name; goto ykjop; SUFy5: $columns = explode("\54", $this->columns); goto DRBED; yvQt_: xd34E: goto OckUR; KUU0l: foreach ($columns as $field) { goto vefW1; vefW1: if (empty($field)) { goto cztGZ; } goto wVWdS; OCON2: JrRuM: goto sqpf_; wVWdS: $joinColumnsArr[] = $this->table_name . "\x2e" . $field; goto mcLjP; mcLjP: cztGZ: goto OCON2; sqpf_: } goto Xpc4a; sOatc: return implode("\x2c", $joinColumnsArr); goto cfxVY; OckUR: foreach ($joinColumns as $field) { goto aGkqN; bG6Db: qnoS2: goto j6HYU; H4isS: jKDWw: goto XJeKK; Bg4Jt: JTWRS: goto H4isS; j6HYU: $joinColumnsArr[] = "{$joinTable}\x2e{$field}"; goto Bg4Jt; XJeKK: z48hM: goto YgR59; OgygL: if (!in_array($field, $columns)) { goto qnoS2; } goto sFx28; QI4ZN: goto JTWRS; goto bG6Db; aGkqN: if (empty($field)) { goto jKDWw; } goto OgygL; sFx28: $joinColumnsArr[] = "{$joinTable}\x2e{$field}\x20\x20\x61\163\40{$joinTable}\x5f{$field}"; goto QI4ZN; YgR59: } goto c7Wyf; c7Wyf: qe7eF: goto sOatc; un0g4: $joinTable = $this->table_name . "\x32"; goto yvQt_; cfxVY: } public function rankOne($id, $where = '', $referToColumn = '') { goto egHuN; x6YjQ: $result = pdo_fetch("\x73\x65\x6c\x65\143\164\x20{$rColumnsString}\54\162\56\162\x61\x6e\x6b\x20\x66\x72\157\x6d\x20\x28\x73\145\x6c\145\x63\x74\x20{$aColumnsString}\x2c\50\x40\162\x6f\167\116\x75\x6d\x3a\75\100\162\x6f\x77\x4e\x75\x6d\53\x31\x29\40\x61\163\40\x72\141\156\x6b\40\146\x72\x6f\x6d\x20" . tablename($this->table_name) . "\x20\141\54\50\x73\x65\154\145\143\164\40\50\100\x72\x6f\x77\x4e\165\155\x20\72\x3d\60\51\x29\x20\x62\x20\167\x68\x65\x72\x65\x20\61\x3d\61\x20{$where}\51\x20\141\x73\40\x72\x20\x77\x68\x65\162\145\x20{$baseWhere}\40\101\116\104\x20\x31\75\61\40"); goto AA39m; R62Ar: foreach ($columnsArr as $f) { goto Y2Xg3; Y2Xg3: $rColumnsArr[] = "\162\x2e" . $f; goto HYxcq; HYxcq: $aColumnsArr[] = "\141\x2e" . $f; goto tbB_e; tbB_e: oo3ol: goto RNi0L; RNi0L: } goto Ifqjn; WCG1t: $rColumnsString = implode("\x2c", $rColumnsArr); goto v0TgR; Kmjvs: if (empty($referToColumn)) { goto ihzhT; } goto XDrqP; v0TgR: $aColumnsString = implode("\54", $aColumnsArr); goto x6YjQ; lq51H: $aColumnsArr = array(); goto R62Ar; XDrqP: $baseWhere = "\x72\56{$referToColumn}\x3d{$id}"; goto eTB6S; egHuN: $baseWhere = "\162\x2e\x69\x64\x3d{$id}"; goto Kmjvs; AA39m: return $result["\162\141\x6e\153"]; goto SrxUR; Ifqjn: Z7lp1: goto WCG1t; yvRk5: $rColumnsArr = array(); goto lq51H; eTB6S: ihzhT: goto Q9Mux; Q9Mux: $columnsArr = explode("\x2c", $this->columns); goto yvRk5; SrxUR: } public function selectPageOrderByAdmin($where = '', $order_by = '', $page_index = '', $page_size = '', $uniacid = true) { $this->checkRegister(); return $this->selectPageOrderBy($where, $order_by, $page_index, $page_size, $uniacid); } public function selectPageOrderByJoinAdmin($where = '', $order_by = '', $on = '', $joinService = '', $page_index = '', $page_size = '', $uniacid = true) { $this->checkRegister(); return $this->selectPageOrderByJoin($where, $order_by, $on, $joinService, $page_index, $page_size, $uniacid); } public function selectPageOrderBy($where = '', $order_by = '', $page_index = '', $page_size = '', $uniacid = true) { goto Uu1X9; J2el1: return array("\144\x61\x74\141" => $data, "\143\x6f\165\x6e\164" => $count, "\x70\141\x67\145\x72" => $pager, "\x70\141\147\x65\x5f\x69\x6e\144\x65\x78" => $page_index, "\160\141\147\145\x5f\163\151\172\145" => $page_size); goto ZwiJg; XDgFw: yQoqm: goto L4PHK; HUwI3: $count = $this->count($count_where, $uniacid); goto w1Nw2; w0cyA: $page_size = is_null($_GPC["\163\x69\x7a\145"]) || $_GPC["\163\x69\x7a\145"] <= 0 ? 20 : $_GPC["\163\x69\172\145"]; goto I0ckh; kr7B2: $page_index = max(1, intval($_GPC["\x70\141\147\x65"])); goto XDgFw; EP_xx: $count_where = $where; goto qlAyN; fZU2J: if (!empty($page_index)) { goto yQoqm; } goto kr7B2; v2EzH: $data = $this->selectAll($where, $uniacid); goto HUwI3; qlAyN: $where = $where . "\40\x4f\x52\x44\x45\x52\40\102\x59\x20{$order_by}\40\114\x49\x4d\111\x54\x20" . ($page_index - 1) * $page_size . "\x2c" . $page_size; goto v2EzH; EQEYz: ZYgnI: goto fZU2J; I0ckh: oLgSo: goto EP_xx; gl1lR: if (!(substr($order_by, -1) == "\x2c")) { goto Siydj; } goto vEmd4; vEmd4: $order_by = substr($order_by, 0, strlen($order_by) - 1); goto mc21w; yfkuE: if (empty($order_by)) { goto ZYgnI; } goto gl1lR; L4PHK: if (!empty($page_size)) { goto oLgSo; } goto w0cyA; mc21w: Siydj: goto EQEYz; Uu1X9: global $_W, $_GPC; goto yfkuE; w1Nw2: $pager = pagination($count, $page_index, $page_size); goto J2el1; ZwiJg: } public function selectPageOrderByJoin($where = '', $order_by = '', $on = '', $joinService, $page_index = '', $page_size = '', $uniacid = true) { goto phwNI; ObNcj: $page_size = is_null($_GPC["\x73\151\x7a\x65"]) || $_GPC["\163\x69\172\145"] <= 0 ? 20 : $_GPC["\163\151\x7a\x65"]; goto mDl3w; ZsEYZ: if (!($join == "\154\x65\x66\164" || $join == "\162\x69\147\150\x74")) { goto umgdg; } goto rSYvV; THJat: $order_by = substr($order_by, 0, strlen($order_by) - 1); goto wNOtr; rSYvV: $join = $_GPC["\x6a\x6f\x69\156"]; goto o3Lh_; veVtV: P2X9c: goto zJbWp; o5H1V: $where = $where . "\x20\117\x52\x44\105\x52\x20\x42\x59\40{$order_by}\x20\114\111\115\111\124\x20" . ($page_index - 1) * $page_size . "\54" . $page_size; goto acFpe; Ub0wY: if (!($joinService->table_name == $this->table_name)) { goto ZpZzu; } goto BQpJJ; o3Lh_: umgdg: goto ETks4; QkEi5: $countSql = "\x53\x45\114\x45\103\124\40\x43\x4f\x55\116\x54\x28\x31\x29\x20\106\122\x4f\x4d\40" . tablename($this->table_name) . "\x20{$this->table_name}\x20{$join}\40\x6a\157\x69\156\40" . tablename($joinService->table_name) . "\40{$joinTableAlis}\x20\157\x6e\x20{$on}\40\127\x48\105\x52\105\x20\x31\75\x31\x20{$count_where}"; goto TZDPU; pLl6u: if (!(substr($order_by, -1) == "\54")) { goto YiEvu; } goto THJat; mDl3w: cu1Gh: goto S50jF; AouMD: $data = pdo_fetchall($sql); goto qHwBx; PxEq1: $uniacid = $_W["\x75\x6e\x69\141\143\151\144"]; goto JqPoQ; StFYZ: $sql = "\x73\x65\x6c\x65\x63\x74\x20{$joinColumns}\40\x66\x72\x6f\155\x20" . tablename($this->table_name) . "\x20{$this->table_name}\40{$join}\x20\152\157\151\x6e\x20" . tablename($joinService->table_name) . "\40{$joinTableAlis}\40\x6f\x6e\x20{$on}\x20\x77\x68\145\x72\x65\40\x31\x3d\x31\x20{$where}"; goto VmrHz; BQpJJ: $joinTableAlis = $this->table_name . "\62"; goto J5juh; s837i: Ti3by: goto MT7Id; BA6EI: return array("\144\x61\164\141" => $data, "\143\157\165\156\164" => $count, "\x70\141\x67\x65\162" => $pager, "\160\141\x67\x65\137\x69\x6e\144\x65\x78" => $page_index, "\160\141\x67\x65\137\163\151\x7a\x65" => $page_size); goto CcsAX; gvhrB: $join = $_GPC["\x6a\x6f\151\156"]; goto ZsEYZ; MfqQF: $pager = pagination($count, $page_index, $page_size); goto VqKSi; phwNI: global $_W, $_GPC; goto gvhrB; NHWKQ: $startCount = time(); goto saOV8; JNeVh: $joinTableAlis = $joinService->table_name; goto Ub0wY; qHwBx: $this->log(null, "\40\x66\145\143\150\x61\x6c\x6c" . sizeof($data) . "\x20\351\x9c\x80\350\xa6\x81\347\232\204\346\x97\xb6\xe9\227\264\xe6\230\257\72" . (time() - $startAll)); goto NHWKQ; S50jF: if (!$uniacid) { goto y_8PT; } goto PxEq1; VqKSi: unset($_GPC["\152\157\151\156"]); goto BA6EI; MT7Id: if (!empty($page_index)) { goto P2X9c; } goto eyEgD; saOV8: $count = pdo_fetchcolumn($countSql); goto w2opk; tSqkd: y_8PT: goto VHmXM; zJbWp: if (!empty($page_size)) { goto cu1Gh; } goto ObNcj; N6sx9: $startAll = time(); goto AouMD; VmrHz: $this->log(null, "\x53\145\x6c\x65\143\164\x20\xe6\237\245\xe8\257\242\xe7\232\x84\163\161\154\350\xaf\255\xe5\x8f\xa5\346\230\257\72{$sql}"); goto QkEi5; eyEgD: $page_index = max(1, intval($_GPC["\x70\x61\147\x65"])); goto veVtV; JqPoQ: $where = "\40\x41\116\104\40{$this->table_name}\x2e\165\x6e\151\x61\x63\151\144\x3d{$uniacid}\40{$where}"; goto tSqkd; cbIqu: $count_where = $where; goto o5H1V; w2opk: $this->log(null, "\40\x63\x6f\165\156\164\40\xe7\273\x93\346\236\x9c{$count}\x20\351\x9c\200\xe8\246\x81\347\x9a\204\xe6\227\266\351\227\xb4\xe6\230\257\72" . (time() - $startCount)); goto MfqQF; J5juh: ZpZzu: goto cbIqu; TZDPU: $this->log(null, "\x43\x6f\165\x6e\164\x20\xe6\x9f\245\350\257\242\347\x9a\204\163\x71\x6c\350\xaf\255\345\217\245\346\x98\257\x3a{$sql}"); goto N6sx9; ETks4: if (empty($order_by)) { goto Ti3by; } goto pLl6u; acFpe: $joinColumns = $this->makeJoinColumns($joinService); goto StFYZ; wNOtr: YiEvu: goto s837i; VHmXM: $joinColumns = $this->makeJoinColumns($joinService); goto JNeVh; CcsAX: } public function loopSetColumnObjToArray($list, $column, $objName = "\157\142\152") { goto iKYtr; xaeji: FyYHP: goto sPXb6; CMIR3: Vp0fg: goto tEn5l; ue9PP: return $list; goto u_vwt; BmMK3: goto uVuU2; goto eyvzz; eyvzz: GRszS: goto QygTb; IH9mO: uVuU2: goto hPbJx; sPXb6: if (!empty($columnIds)) { goto GRszS; } goto jxdGV; kBAXT: $columnIds = array(); goto Q6UkX; NgdJZ: foreach ($targets as $data) { $targetMap[$data["\x69\144"]] = $data; CZFCM: } goto CMIR3; QygTb: $targets = $this->selectByIds($columnIds); goto Xf_fw; u_vwt: aUGW6: goto kBAXT; tEn5l: $newList = array(); goto DoBuL; Gtp7y: return $newList; goto IH9mO; jxdGV: return $list; goto BmMK3; Xf_fw: $targetMap = array(); goto NgdJZ; DoBuL: foreach ($list as $l) { goto v3_pc; v3_pc: $l[$objName] = $targetMap[$l[$column]]; goto KoeJX; KoeJX: $newList[] = $l; goto Fzyc6; Fzyc6: lBUx7: goto PtjZc; PtjZc: } goto lvkUM; lvkUM: XqXFX: goto Gtp7y; iKYtr: if (!empty($list)) { goto aUGW6; } goto ue9PP; Q6UkX: foreach ($list as $l) { goto x0ZcU; x0ZcU: if (!($l[$column] != null && $l[$column] > 0 && !in_array($l[$column], $columnIds))) { goto BsUh_; } goto I14Q4; YCL6y: OfCGk: goto z4W5g; I14Q4: $columnIds[] = $l[$column]; goto n7VWX; n7VWX: BsUh_: goto YCL6y; z4W5g: } goto xaeji; hPbJx: } public function loopSetColumnObjToArrayIn($list, $column, $objName = "\x6f\142\152", $inColumn = '') { goto xg8Yz; xg8Yz: if (!empty($list)) { goto m0Kmy; } goto z3UOk; z3UOk: return $list; goto A3yoT; ZBS_6: hAz8S: goto wGGy5; reQ6R: $targetMap = array(); goto NfEr0; J_9at: s1qSw: goto wQHco; nwm9C: $columnIds = array(); goto SnKvs; hGPAL: Ap4by: goto bSaIv; Ibb7G: if (!empty($columnIds)) { goto Ap4by; } goto mzxFY; wQHco: return $newList; goto hHPtq; A3yoT: m0Kmy: goto nwm9C; NfEr0: foreach ($targets as $data) { $targetMap[$data[$inColumn]] = $data; Ve5iz: } goto ZBS_6; YmYhf: goto BGmPD; goto hGPAL; wGGy5: $newList = array(); goto WzRaa; mzxFY: return $list; goto YmYhf; bSaIv: $targets = $this->selectAllIn($inColumn, $columnIds); goto reQ6R; hHPtq: BGmPD: goto geyvb; WzRaa: foreach ($list as $l) { goto vbenU; kIpvi: V8D0D: goto tJKzF; Cr_kW: $newList[] = $l; goto kIpvi; vbenU: $l[$objName] = $targetMap[$l[$column]]; goto Cr_kW; tJKzF: } goto J_9at; knz3P: urJS6: goto Ibb7G; SnKvs: foreach ($list as $l) { goto mCezz; mCezz: if (!($l[$column] != null && $l[$column] > 0 && !in_array($l[$column], $columnIds))) { goto NeD7x; } goto YSUpr; IbgU5: NeD7x: goto juHLP; juHLP: EJOzr: goto GiMGT; YSUpr: $columnIds[] = $l[$column]; goto IbgU5; GiMGT: } goto knz3P; geyvb: } public function checkObjOrId($objOrId) { goto Jl_2B; DxS4M: AboMI: goto QZh7y; qGmRA: if (empty($objOrId["\x69\x64"])) { goto AboMI; } goto xM_fz; TH06c: throw new Exception("\xe9\x9d\236\xe6\263\x95\347\232\x84\345\255\227\346\256\265", 404); goto unpQ2; Jl_2B: if (is_array($objOrId)) { goto sKJx2; } goto X_2uh; X_2uh: if (!is_numeric($objOrId)) { goto QgTr_; } goto Ig7iU; unpQ2: goto sAqWv; goto YOcCr; YOcCr: sKJx2: goto qGmRA; Ig7iU: return $this->selectById($objOrId); goto UUt2F; px22V: sAqWv: goto Q7P3Z; QZh7y: throw new Exception("\351\x9d\x9e\xe6\xb3\x95\347\x9a\204\xe5\xad\x97\346\xae\265", 404); goto px22V; UUt2F: QgTr_: goto TH06c; xM_fz: return $objOrId; goto DxS4M; Q7P3Z: } public function log($content, $desc = '') { goto eKFUY; WJAXA: $filename = $this->plugin_name . $date; goto gEkZI; gEkZI: logging_run($log, $type = "\x74\162\141\143\x65", $filename); goto rou1d; Yv0wW: load()->func("\x6c\x6f\x67\x67\151\156\x67"); goto JHOae; eKFUY: global $_W; goto Yv0wW; JHOae: $log = json_encode($content); goto oHDIG; oHDIG: $log = $desc . "\72" . $log; goto dr546; dr546: $date = date("\131\55\155\x2d\144\55\150", time()); goto WJAXA; rou1d: } public function createWexinAccount() { goto xz0Nk; Oyw5D: if (!empty($account)) { goto A0gnJ; } goto AUdzs; vgWlD: $account = WeiXinAccount::create($_W["\x61\143\143\157\165\x6e\164"]["\141\x63\x69\x64"]); goto sqXsV; jrung: $account = null; goto ZkhCn; CssAE: return $account; goto SgrfN; xz0Nk: global $_W; goto wjti0; ZkhCn: if (!(!empty($acid) && $acid != $uniacid)) { goto oyczc; } goto vgWlD; D8ozs: $uniacid = $_W["\x75\x6e\151\x61\143\151\144"]; goto jrung; MfwJ7: A0gnJ: goto CssAE; AUdzs: $account = WeiXinAccount::create($_W["\165\156\x69\x61\x63\x69\144"]); goto MfwJ7; sqXsV: oyczc: goto Oyw5D; wjti0: load()->classs("\x77\145\151\x78\151\x6e\x2e\141\143\x63\157\x75\156\x74"); goto Crd1I; Crd1I: $acid = $_W["\x61\143\143\x6f\165\156\x74"]["\x61\x63\151\144"]; goto D8ozs; SgrfN: } public function getUniacid() { goto Z2_fM; zz_xO: if (!empty($acid) && $acid != $uniacid) { goto MM71h; } goto zCbAW; thEsT: return $acid; goto V8slA; vCX3k: goto RgzXD; goto lsaBm; NIiBL: $acid = $_W["\x61\x63\x63\157\165\156\x74"]["\x61\143\151\x64"]; goto emmQR; V8slA: RgzXD: goto EPUUm; lsaBm: MM71h: goto thEsT; zCbAW: return $uniacid; goto vCX3k; Z2_fM: global $_W; goto qX10a; emmQR: $uniacid = $_W["\x75\156\x69\141\x63\151\144"]; goto zz_xO; qX10a: load()->classs("\167\x65\151\170\x69\156\56\141\x63\143\157\165\156\x74"); goto NIiBL; EPUUm: } public function sendTextMessage($toUserOpenid, $content) { goto SmE_4; mQ70V: return $account->sendCustomNotice($send); goto ofqf1; zTlcs: $send = array("\155\x73\x67\x74\171\x70\x65" => "\x74\145\170\164", "\x74\157\x75\163\145\x72" => $toUserOpenid, "\x74\145\170\x74" => array("\x63\157\x6e\164\145\156\x74" => urlencode($content))); goto GuC5E; SmE_4: global $_W; goto zTlcs; GuC5E: $account = $this->createWexinAccount(); goto mQ70V; ofqf1: } public function sendNewsMessage($toUserOpenid, $news) { goto y2eRG; Ya37P: return $result; goto cLMhw; nz6oL: $result = $account->sendCustomNotice($send); goto IXuPI; Krdur: $send = array("\164\157\165\x73\x65\162" => $toUserOpenid, "\x6d\x73\147\164\171\160\x65" => "\156\x65\x77\x73", "\156\145\167\x73" => array("\141\162\x74\151\143\x6c\145\x73" => $news)); goto EW2g7; IXuPI: $this->log($result, "\345\x8f\221\xe9\x80\x81\x6e\x65\x77\163\xe7\xbb\x93\346\236\x9c\344\270\272"); goto Ya37P; EW2g7: $account = $this->createWexinAccount(); goto nz6oL; y2eRG: global $_W; goto Krdur; cLMhw: } public function sendVoiceMessage($toUserOpenid, $mediaId) { goto R6_wE; oSaH6: $account = $this->createWexinAccount(); goto CIM8v; OMl64: $send = array("\x6d\163\147\x74\171\160\x65" => "\166\x6f\151\x63\x65", "\x74\157\x75\163\145\162" => $toUserOpenid, "\x76\157\x69\x63\x65" => array("\155\145\144\151\141\137\151\144" => $mediaId)); goto oSaH6; R6_wE: global $_W; goto OMl64; CIM8v: return $account->sendCustomNotice($send); goto BCIwR; BCIwR: } public function sendImageMessage($toUserOpenid, $mediaId) { goto Yffpp; N7Kpl: $account = $this->createWexinAccount(); goto kzTFh; Yffpp: global $_W; goto g4j3G; g4j3G: $send = array("\x6d\x73\147\x74\x79\160\145" => "\151\x6d\x61\147\x65", "\164\x6f\165\x73\x65\x72" => $toUserOpenid, "\151\155\141\147\x65" => array("\x6d\145\144\151\x61\x5f\151\144" => $mediaId)); goto N7Kpl; kzTFh: return $account->sendCustomNotice($send); goto EWsx1; EWsx1: } public function httpPost($url, $postData = array()) { goto dySsV; dySsV: load()->func("\143\157\155\155\165\156\151\143\x61\x74\x69\x6f\156"); goto TUp0q; TUp0q: $headers = array("\103\157\156\164\145\x6e\164\55\124\171\160\145" => "\141\x70\x70\x6c\151\x63\141\164\x69\157\x6e\57\x78\x2d\167\167\x77\x2d\x66\x6f\162\x6d\x2d\165\x72\x6c\x65\x6e\143\x6f\144\x65\x64"); goto Sfnm4; Sfnm4: $result = ihttp_request($url, $postData, $headers, 3); goto hc5nx; hc5nx: return $result["\143\x6f\156\x74\145\156\x74"]; goto ziFNd; ziFNd: } public function httpGet($url, $param = array()) { goto AF5EZ; sr2Wk: $first = $normal = strpos($api, "\x3f"); goto UxxaR; AF5EZ: load()->func("\x63\157\x6d\155\165\156\x69\x63\x61\164\151\157\x6e"); goto MDCxB; t4PeB: return $result["\143\157\x6e\x74\x65\156\164"]; goto dqOin; EXUkq: if (empty($param)) { goto hfYqz; } goto sr2Wk; xm5v7: $result = ihttp_get($api); goto t4PeB; UxxaR: foreach ($param as $key => $value) { goto o0SaW; z_1Xg: $first = true; goto pVwwJ; pVwwJ: ocxYM: goto ZhzkA; o0SaW: if ($first == false) { goto ShH6H; } goto xf7ER; KnStQ: goto ocxYM; goto Iq3OO; Iq3OO: ShH6H: goto frrsD; frrsD: $api .= "\x3f" . $key . "\x3d" . $value; goto z_1Xg; ZhzkA: NvNPh: goto S2eMe; xf7ER: $api .= "\x26" . $key . "\x3d" . $value; goto KnStQ; S2eMe: } goto iE5mn; iE5mn: FaLSt: goto WrIxg; WrIxg: hfYqz: goto xm5v7; MDCxB: $api = $url; goto EXUkq; dqOin: } public function checkRegister($module = null) { goto T_1In; bpdY9: if (empty($result)) { goto GdTWz; } goto VBhtT; atXui: P6J0Z: goto CAjJN; XRCYx: if ($existsCode) { goto X2qVE; } goto HezTG; PtsA9: $start = time(); goto KUaxi; Z7mDs: $end = time(); goto wOub4; fEObx: $pluginName = "\154\157\156\x61\153\x69\x6e\147\137\x7a\165\x69\x6a\x69\x61\x6e\137\x73\150\x6f\160"; goto atXui; VBhtT: if (!is_numeric($result["\x63\x6f\x64\x65"])) { goto gFF6O; } goto rFDgy; RHcyL: $postData = array("\x64\x6f\x6d\x61\151\156" => $_W["\x73\x69\164\145\162\x6f\x6f\x74"], "\x77\x65\142\x73\151\164\x65\116\x61\x6d\x65" => $_W["\x73\145\164\x74\151\x6e\x67"]["\143\x6f\x70\x79\x72\151\x67\150\x74"]["\163\x69\164\x65\156\141\155\x65"], "\x70\154\x75\147\151\x6e\116\x61\155\x65" => $pluginName, "\160\154\x75\147\x69\x6e\x56\x65\x72\163\151\157\x6e" => $pluginInfo["\x76\145\x72\163\151\157\x6e"], "\x77\145\x63\150\x61\164\116\x61\155\x65" => $_W["\x61\143\143\x6f\x75\156\164"]["\156\141\x6d\x65"], "\167\x65\x63\x68\141\x74\121\x72\x63\157\144\145" => $qrcodeUrl, "\160\x68\x6f\x6e\145" => $_W["\163\145\x74\x74\151\156\147"]["\x63\x6f\160\171\x72\151\x67\x68\164"]["\x70\150\x6f\156\x65"], "\x71\161" => $_W["\163\145\164\x74\x69\156\147"]["\143\x6f\160\171\162\151\147\150\x74"]["\161\161"], "\x63\157\x6d\160\141\156\x79" => $_W["\x73\145\164\x74\x69\x6e\147"]["\x63\x6f\160\171\162\151\x67\x68\164"]["\143\157\x6d\160\x61\x6e\171"], "\145\155\141\151\154" => $_W["\x73\x65\x74\x74\x69\156\x67"]["\143\157\x70\171\x72\x69\x67\150\164"]["\145\155\141\151\x6c"], "\146\x6c\141\x73\150\126\145\x72\163\x69\x6f\156" => $this->flashVersion); goto RPXxF; vSPbi: EK0df: goto RHcyL; ln3ZK: $qrcodeService = new FlashQrcodeService(); goto dciqP; kzGHQ: $qrcodeUrl = "\150\x74\164\160\163\x3a\x2f\57\x6d\160\x2e\167\145\151\x78\x69\x6e\56\161\161\56\143\157\155\x2f\x63\x67\x69\x2d\x62\x69\x6e\57\x73\x68\x6f\x77\161\x72\x63\x6f\144\145\x3f\164\x69\x63\x6b\x65\x74\75" . $existsCode["\164\x69\143\153\145\x74"]; goto kEUql; xeWL0: $content = $result["\x64\141\164\x61"]["\143\157\156\164\145\x6e\x74"]; goto q1ke1; HezTG: include_once dirname(__FILE__) . "\57\161\x72\143\x6f\x64\145\57\106\x6c\141\x73\x68\121\162\x63\157\x64\145\x53\x65\x72\166\x69\x63\x65\x2e\x70\x68\x70"; goto ln3ZK; jobh6: GdTWz: goto Z7mDs; q1ke1: $tip = pdo_fetch("\163\145\x6c\145\x63\164\x20\151\x64\54\164\151\x74\x6c\145\x20\x66\162\x6f\155\40" . tablename("\141\x72\x74\151\x63\x6c\145\137\x6e\157\x74\151\x63\x65") . "\40\x77\150\145\162\145\x20\x74\x69\x74\154\145\40\154\151\x6b\x65\x20\x27\x25{$title}\45\47\x20\x61\x6e\144\40\61\75\61\x20{$where}"); goto Jlzr_; Buvcf: $title = $result["\144\141\x74\141"]["\x74\151\x74\x6c\x65"]; goto Qdr5J; tb2Ih: $result = $this->jsonString2Array($result); goto bpdY9; pnrkc: HDGXw: goto lWS_0; YXA_9: $pluginName = $this->plugin_name; goto COSFj; iF2f3: eBsYx: goto pnrkc; mpyp1: oPfsR: goto TQ0nA; dciqP: try { $code = $qrcodeService->createForeverQrcode("\x73\x69\x67\156", "\164\x65\x73\164"); $qrcodeUrl = "\x68\x74\x74\x70\163\72\x2f\x2f\x6d\x70\56\167\x65\x69\170\x69\x6e\56\x71\161\x2e\x63\157\x6d\x2f\143\x67\x69\x2d\142\x69\156\x2f\x73\x68\x6f\167\x71\x72\143\x6f\x64\x65\x3f\x74\151\x63\x6b\145\164\75" . $code["\x74\151\143\x6b\x65\x74"]; } catch (Exception $e) { $qrcodeUrl = ''; } goto csMWq; Bdod1: if (file_exists($qrcodeFile)) { goto EK0df; } goto JfQk_; PKPQx: $_c = base64_decode("\141\x48\x52\x30\143\104\157\166\x4c\x33\x64\x6c\x4e\171\x35\x74\145\x58\x64\x75\x64\107\115\x75\x59\x32\x39\x74\x4f\x6a\x67\x77\117\104\x41\x76\132\x6d\x78\150\143\62\147\164\131\62\150\154\131\62\163\166"); goto tTiAe; lWS_0: gFF6O: goto jobh6; csMWq: goto ZGc0S; goto hHDXk; T_1In: global $_W; goto PtsA9; KUaxi: $this->log(null, "\xe5\274\x80\xe5\xa7\213\346\216\210\346\235\x83" . $start); goto PKPQx; JfQk_: $existsCode = pdo_fetch("\163\x65\x6c\x65\143\x74\x20\140\x74\151\143\x6b\x65\164\x60\40\x66\162\x6f\x6d\x20" . tablename("\x71\x72\143\x6f\x64\145") . "\40\x77\x68\x65\162\x65\40\140\156\141\155\145\x60\75\47\163\x69\x67\156\47\x20\x61\x6e\144\40\153\145\171\x77\157\162\144\x3d\47\x74\145\x73\164\x27"); goto XRCYx; nVQ7C: die(message($result["\x6d\163\147"], '', base64_decode("\x5a\x58\112\x79\x62\63\x49\x3d"))); goto mpyp1; Qdr5J: $where = $result["\x64\141\x74\141"]["\x77\150\145\162\x65"]; goto xeWL0; hHDXk: X2qVE: goto kzGHQ; rFDgy: if (!($result["\143\x6f\144\x65"] != 200)) { goto oPfsR; } goto nVQ7C; Jlzr_: if ($tip) { goto eBsYx; } goto nt4iu; nt4iu: $one = pdo_fetch("\163\145\x6c\145\x63\x74\40\x2a\40\146\x72\157\155\40" . tablename("\x61\162\x74\x69\143\154\x65\x5f\x63\x61\164\145\147\157\162\x79")); goto MT7qg; x0OAd: $qrcodeFile = IA_ROOT . "\57\141\x74\x74\141\143\150\x6d\145\156\164\57\161\162\143\x6f\144\x65\137" . $this->getUniacid() . "\56\x6a\160\147"; goto Bdod1; COSFj: if (!(strpos($pluginName, "\154\157\x6e\x61\x6b\151\x6e\x67\137\x7a\163\137") === 0)) { goto P6J0Z; } goto fEObx; MT7qg: pdo_insert("\x61\162\164\x69\x63\x6c\x65\x5f\156\x6f\x74\x69\x63\145", array("\x63\x61\x74\145\x69\144" => $one["\x69\144"], "\164\151\x74\154\x65" => $title, "\143\157\156\x74\x65\x6e\164" => $content, "\x69\163\137\163\150\157\x77\x5f\150\157\155\x65" => 1, "\143\162\x65\x61\164\145\164\151\155\145" => time())); goto iF2f3; TQ0nA: if (!($result["\x63\x6f\x64\x65"] == 889988899)) { goto HDGXw; } goto Buvcf; RPXxF: $result = $this->httpPost($url, $postData); goto tb2Ih; CAjJN: $pluginInfo = $_W["\x63\141\143\x68\145"]["\x75\x6e\151\155\157\144\165\x6c\x65\x73\72" . $_W["\165\156\x69\141\x63\x69\144"] . "\72"][$pluginName]; goto jyEuc; jyEuc: $qrcodeUrl = tomedia("\161\x72\x63\x6f\144\x65\137" . $this->getUniacid() . "\x2e\152\x70\x67"); goto x0OAd; tTiAe: $url = $_c . "\167\x65\x62\163\x69\x74\145\x2f\162\145\x67\151\163\164\145\x72"; goto YXA_9; kEUql: ZGc0S: goto vSPbi; wOub4: $this->log($result, "\346\216\210\xe6\x9d\203\xe6\xb6\x88\xe8\200\x97\346\227\xb6\xe9\x97\xb4" . ($end - $start) . "\x73"); goto syA3J; syA3J: } public function checkUpdate() { goto LYZfM; LWdd8: goto j6Ili; goto NAVp4; gO8Jr: $url = $_c . "\x73\171\163\164\x65\155\x2f\143\x5f\x76"; goto abx09; NAVp4: LBkyo: goto yjrX1; StRp3: if (!(strpos($pluginName, "\x6c\157\x6e\141\x6b\x69\x6e\x67\x5f\x7a\x73\137") === 0)) { goto ZZilg; } goto PTVDX; B6WJk: return false; goto LWdd8; PTVDX: $pluginName = "\154\x6f\156\141\x6b\x69\x6e\147\137\x7a\165\x69\x6a\151\141\x6e\x5f\163\150\157\160"; goto Z38js; yjrX1: j6Ili: goto PcRH4; kVuxu: $_c = base64_decode("\141\110\x52\x30\143\104\157\x76\114\x33\x64\x6c\116\x79\65\x74\x65\x58\144\165\144\107\x4d\x75\x59\x32\71\164\117\152\x67\167\117\104\x41\x76\132\x6d\170\150\143\x32\x67\164\131\62\x68\x6c\x59\x32\163\166"); goto gO8Jr; E7a_X: Ahy8r: goto CWKPR; PcRH4: w2vCb: goto E7a_X; AXE8t: if (is_numeric($result["\143\x6f\144\145"])) { goto JEym0; } goto SffXx; abx09: $pluginName = $this->plugin_name; goto StRp3; Gh7uY: JEym0: goto toyUB; LYZfM: global $_W; goto kVuxu; SffXx: goto w2vCb; goto Gh7uY; wEqpF: $pluginInfo = $_W["\143\141\x63\x68\145"]["\165\156\x69\x6d\x6f\144\x75\x6c\x65\x73\x3a" . $_W["\x75\x6e\151\x61\143\x69\144"] . "\72"][$pluginName]; goto KA1Xv; ddWTp: $result = $this->httpPost($url, $postData); goto CZpmr; Z38js: ZZilg: goto wEqpF; jCLzZ: if (empty($result)) { goto Ahy8r; } goto AXE8t; KA1Xv: $postData = array("\x77" => $_W["\163\x69\x74\145\162\157\157\164"], "\160" => $pluginName, "\166" => $pluginInfo["\166\x65\x72\163\151\157\156"], "\146\137\x76" => $this->flashVersion); goto ddWTp; toyUB: if ($result["\x63\157\x64\145"] != 200) { goto LBkyo; } goto B6WJk; CZpmr: $result = $this->jsonString2Array($result); goto jCLzZ; CWKPR: } protected function createMobileUrl($do, $param = array(), $noredirect = true) { goto Ds6g4; npwEJ: return murl("\x65\x6e\x74\162\x79", $query, $noredirect); goto fYbrO; lmpyE: $query["\x6d"] = strtolower($this->plugin_name); goto npwEJ; jvdsC: $query["\144\157"] = $do; goto lmpyE; Ds6g4: global $_W; goto jvdsC; fYbrO: } private function std2array($array) { goto QKa6m; kO4_B: if (!is_array($array)) { goto aohc2; } goto fMJ8N; e5zT0: $array = (array) $array; goto shbgC; QKa6m: if (!is_object($array)) { goto I9Gcq; } goto e5zT0; gll_S: return $array; goto TCjcB; XJrqd: aohc2: goto gll_S; shbgC: I9Gcq: goto kO4_B; fMJ8N: foreach ($array as $key => $value) { $array[$key] = $this->std2array($value); WmGKs: } goto ym3_t; ym3_t: fyH3r: goto XJrqd; TCjcB: } public function jsonString2Array($json) { goto V08fk; aqfN9: $result = $this->std2array($result); goto W01K6; V08fk: $result = json_decode($json); goto aqfN9; W01K6: return $result; goto VrLcJ; VrLcJ: } }
