{template 'common/header'}
<script type='text/javascript' src='resource/js/lib/jquery-1.11.1.min.js'></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/jquery.gcjs.js"></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/jquery.form.js"></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/tooltipbox.js"></script>
<style type="text/css">
.red {float:left;color:red}
.white{float:left;color:#fff}

.tooltipbox {
	background:#fef8dd;border:1px solid #c40808; position:absolute; left:0;top:0; text-align:center;height:20px;
	color:#c40808;padding:2px 5px 1px 5px; border-radius:3px;z-index:1000;
}
.red { float:left;color:red}
</style>
<DIV id="new">
<style>
#new a{margin-left:10px;}
.btn-group{margin-top:5px;}
</style>
<A class="btn btn-primary btn-sm" href="{php echo '../app/'.$this->createMobileUrl('Index',array('rid'=>$id))}" target="__blank"><i class="fa fa-edit"></i>查看上墙内容入口</A> 
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'all','id'=>$id))}" onclick="return confirm('清空所有墙内内容，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空墙内内容</a>      

<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'allperson','id'=>$id))}" onclick="return confirm('清空所有录入的人数，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空录入的总人数</a>         

<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'yyy','id'=>$id))}" onclick="return confirm('清空所有摇一摇数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置摇一摇</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'yyy','id'=>$id))}" onclick="return confirm('清空所有摇一摇数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空摇一摇</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'vote','id'=>$id))}" onclick="return confirm('清空所有投票票数数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置投票数目</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'cj','id'=>$id))}" onclick="return confirm('清空所有已经中奖人员，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置抽奖结果</a><a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'bahe','id'=>$id))}" onclick="return confirm('清空所有拔河数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置拔河</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'bahe','id'=>$id))}" onclick="return confirm('清空所有拔河数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空拔河</a></DIV><br><br>
<div class="navbar navbar-default navbar-static-top">
    <div class="container-fluid" style="background-color: rgb(238, 238, 238);padding:0px;margin:0px;">
	<div class="btn-group">
			<a type="button" class="btn {if $_GPC['do']=='ac_url'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('ac_url', array('id' => $id))}"><i class="fa fa-edit"></i>活动链接管理</a></div>
    <div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('manage', array('id' => $id, 'op' =>'list'))}"><i class="fa fa-users"></i>人员列表</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('manage', array('id' => $id, 'isshow' => 0))}"><i class="fa fa-toggle-off"></i>上墙待审</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('manage', array('id' => $id, 'isshow' => 1))}"><i class="fa fa-toggle-on"></i>上墙已审</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('signmanage', array('id' => $id, 'status' => 2))}"><i class="fa fa-toggle-off"></i>签到待审</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default"  href="{php echo $this->createWebUrl('signmanage', array('id' => $id, 'status' => 1))}"><i class="fa fa-toggle-on"></i>签到已审</a>
	</div>
	
	<div class="btn-group">
			<a type="button" class="btn {if $operation == 'display'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('Checkvote',array('id' => $id,'op' =>'display'))}"><i class="fa fa-list"></i>投票列表</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn {if empty($vote['id']) && $operation == 'post'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('Checkvote',array('id' => $id,'op' =>'post'))}"><i class="fa fa-plus-square"></i>添加投票</a>
	</div>
	{if !empty($vote['id']) &&  $operation == 'post'}<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('Checkvote',array('id' => $id,'op' =>'post','voteid'=>$vote['id']))}"><i class="fa fa-edit"></i>编辑投票</a></div>{/if}

	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('awardmanage', array('id' => $id))}"><i class="fa fa-gift"></i>抽奖管理</a>
    </div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('awardlist', array('id' => $id))}"><i class="fa fa-users"></i>中奖名单</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('vote_person', array('id' => $id))}"><i class="fa fa-users"></i>投票人员</a>
		</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('yyyres', array('id' => $id))}"><i class="fa fa-users"></i>摇一摇名单</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('bahe_phb', array('id' => $id))}"><i class="fa fa-users"></i>拔河名单</a></div>
			<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('bahe_setting', array('id' => $id))}"><i class="fa fa-plus"></i>拔河配置</a></div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('blacklist', array('id' => $id))}"><i class="fa fa-users"></i>粉丝黑名单</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('modules_manage', array('id' => $id))}"><i class="fa fa-list"></i>插件列表</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn {if empty($check['id']) && $op == 'list' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}"  href="{php echo $this->createWebUrl('signcheck',array('id'=>$id))}"><i class="fa fa-toggle-off"></i>验证管理</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn  {if empty($check['id']) && $op=='post' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('signcheck',array('id'=>$id,'op' =>'post'))}"><i class="fa fa-toggle-off"></i>添加验证</a>
	</div>
	
	{if !empty($check['id']) && $op == 'post' && $_GPC['do']=='signcheck'}
	<div class="btn-group">
			<a type="button" class="btn {if !empty($check['id']) && $op == 'post' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('signcheck',array('id'=>$id,'op' =>'post'))}"><i class="fa fa-toggle-off"></i>编辑验证</a>
	</div>
	{/if}
	<div class="btn-group">
			<a type="button" class="btn {if $op == 'list' && $_GPC['do']=='mobileupload'}btn-success{else}btn-default{/if}"  href="{php echo $this->createWebUrl('mobileupload',array('id'=>$id))}"><i class="fa fa-toggle-off"></i>导入列表</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn {if $op == 'post' && $_GPC['do']=='mobileupload'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('mobileupload',array('id' => $id,'op'=>'post'))}"></i>导入文件</a>
   </div>
   <div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('howuse',array('id' => $id))}"></i>使用说明书</a>
   </div>
</div>
</div>
{if $operation == 'display'}
<div class="main panel panel-success">
<div class="panel-heading">
				投票数据<br><br>
				1: <strong>为了保证投票公平公正、尽量不要随意修改项目投票数目</strong><br><br>
				2: <strong>投票项目 =< 8 显示比较友好</strong>
</div>
	<div class="panel-body table-responsive">
		<table class="table table-hover">
			<thead class="navbar-inner">
				<tr>
					<th>ID</th>					
					<th>投票名称</th>
					<th>投票图片</th>
					<th>所属活动名称</th>
					<th>票数</th>
					<th >操作</th>
				</tr>
			</thead>
			<tbody>
				{loop $list $key $vote}
				<tr>
					<td><span class="label label-danger">{php echo $key+1;}</span></td>
					<td><span class="label label-success">{$vote['name']}</span></td>
					<td><img src="{$_W['attachurl']}{$vote['vote_img']}" width=50px height=50px /></td>
					<td><span class="label label-info">{$vote['ridname']}</span></td>
					<td><span class="label label-warning"><font color=red>{$vote['res']} </font>票</span></td>
					<td style="text-align:left;">
						<a href="{php echo $this->createWebUrl('Checkvote', array('id'=>$id,'op' => 'post', 'voteid' => $vote['id']))}" class="btn btn-success btn-sm" data-toggle="tooltip" data-placement="top" title="修改"><i class="fa fa-edit"></i></a>
						<a href="{php echo $this->createWebUrl('Checkvote', array('id'=>$id,'op' => 'delete', 'voteid' => $vote['id']))}"class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="删除" onclick="return confirm('删除将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i></a>
					</td>
				</tr>
				{/loop}
			</tbody>
		</table>
		{$pager}
	</div>
</div>
<script>
	require(['bootstrap'],function($){
		$('.btn').hover(function(){
			$(this).tooltip('show');
		},function(){
			$(this).tooltip('hide');
		});
	});
</script>
{elseif $operation == 'post'}

<div class="main">
	<form action="" method="post" class="form-horizontal form" enctype="multipart/form-data" onsubmit='return formcheck()'>
		<input type="hidden" name="voteid" value="{$vote['id']}" />
		<div class="panel panel-success">
			<div class="panel-heading">
				投票项目
			</div>
			<div class="panel-body">
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">投票项目名称</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='name' name="name" class="form-control" value="{$vote['name']}" placeholder="请输入投票项目名称" />
						<span class="help-block">投票项目名称</span>
					</div>
				</div>
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span class="label label-success">投票项目图片</span></label>
					<div class="col-sm-9">
						{php echo tpl_form_field_image('vote_img', $vote['vote_img']);}
						<span class="help-block">投票项目图片 规格172px*172px</span>
					</div>
				</div>
				{if $vote['id']}
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">当前所得票数</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='res' name="res" class="form-control" value="{$vote['res']}" />
						<span class="help-block">当前所得票数</span>
					</div>
				</div>
				{/if}
				
			</div>
		</div>
    <div class="form-group col-sm-12">
	<input type="submit" name="submit" value="提交" class="btn btn-primary col-lg-1" />
	<input type="hidden" name="token" value="{$_W['token']}" />
	</div>
	</form>
</div>

<script language='javascript'>
	function formcheck() {
		if ($("#name").val()=='') {
			alert("请填写投票项目名称!");
			return false;
		}

		if ($("input[name='vote_img']").val()=='') {
			alert("请上传投票图片!");
			return false;
		}
		return true;
	}
</script>
{/if}



	
{template 'common/footer'}