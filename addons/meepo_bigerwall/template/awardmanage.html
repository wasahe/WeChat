{template 'common/header'}
<script type='text/javascript' src='resource/js/lib/jquery-1.11.1.min.js'></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/jquery.gcjs.js"></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/jquery.form.js"></script>
<script type="text/javascript" src="../addons/ewei_shopping/images/tooltipbox.js"></script>
<style type="text/css">
.red {float:left;color:red}
.white{float:left;color:#fff}

.tooltipbox {
	background:#fef8dd;border:1px solid #c40808; position:absolute; left:0;top:0; text-align:center;height:20px;
	color:#c40808;padding:2px 5px 1px 5px; border-radius:3px;z-index:1000;
}
.red { float:left;color:red}
</style>
<DIV id="new">
<style>
#new a{margin-left:10px;}
.btn-group{margin-top:5px;}
</style>
<A class="btn btn-primary btn-sm" href="{php echo '../app/'.$this->createMobileUrl('Index',array('rid'=>$id))}" target="__blank"><i class="fa fa-edit"></i>查看上墙内容入口</A> 
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'all','id'=>$id))}" onclick="return confirm('清空所有墙内内容，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空墙内内容</a>      

<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'allperson','id'=>$id))}" onclick="return confirm('清空所有录入的人数，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空录入的总人数</a>         

<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'yyy','id'=>$id))}" onclick="return confirm('清空所有摇一摇数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置摇一摇</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'yyy','id'=>$id))}" onclick="return confirm('清空所有摇一摇数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空摇一摇</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'vote','id'=>$id))}" onclick="return confirm('清空所有投票票数数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置投票数目</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'cj','id'=>$id))}" onclick="return confirm('清空所有已经中奖人员，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置抽奖结果</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'reset','del'=>'bahe','id'=>$id))}" onclick="return confirm('清空所有拔河数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>重置拔河</a>
<a class="btn btn-warning btn-sm" href="{php echo $this->createWebUrl('manage',array('type'=>'delete','del'=>'bahe','id'=>$id))}" onclick="return confirm('清空所有拔河数据，将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i>清空拔河</a>
</DIV><br><br>
<div class="navbar navbar-default navbar-static-top">
    <div class="container-fluid" style="background-color: rgb(238, 238, 238);padding:0px;margin:0px;">
		<div class="btn-group">
			<a type="button" class="btn {if $_GPC['do']=='ac_url'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('ac_url', array('id' => $id))}"><i class="fa fa-edit"></i>活动链接管理</a></div>					
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('manage', array('id' => $id, 'op' =>'list'))}"><i class="fa fa-users"></i>人员列表</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default"href="{php echo $this->createWebUrl('manage', array('id' => $id, 'isshow' => 0))}"><i class="fa fa-toggle-off"></i>上墙待审</a>	 
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default"href="{php echo $this->createWebUrl('manage', array('id' => $id, 'isshow' => 1))}"><i class="fa fa-toggle-on"></i>上墙已审</a>	 
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('signmanage', array('id' => $id, 'status' => 2))}"><i class="fa fa-toggle-off"></i>签到待审</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('signmanage', array('id' => $id, 'status' => 1))}"><i class="fa fa-toggle-on"></i>签到已审</a>
		</div>
        <div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('Checkvote',array('id' => $id,'op' =>'display'))}"><i class="fa fa-list"></i>投票列表</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn {if $operation == 'display'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('awardmanage', array('id'=>$id,'op' =>'display'))}"><i class="fa fa-gift"></i>奖品列表
			</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn {if empty($cj['id']) && $operation == 'post'}btn-success{else}btn-default{/if}"  href="{php echo $this->createWebUrl('awardmanage', array('id'=>$id,'op' =>'post'))}"><i class="fa fa-plus-square"></i>添加奖品
			</a>
		</div>
		{if !empty($cj['id']) &&  $operation == 'post'}<div class="btn-group">
			<a type="button" class="btn btn-success"  href="{php echo $this->createWebUrl('awardmanage', array('id'=>$id,'op' =>'post','cjid'=>$cj['id']))}"><i class="fa fa-edit"></i>编辑奖品</a>
		</div>{/if}
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('awardlist', array('id' => $id))}"><i class="fa fa-users"></i>中奖名单</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('vote_person', array('id' => $id))}"><i class="fa fa-users"></i>投票人员</a>
		</div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('yyyres', array('id' => $id))}"><i class="fa fa-users"></i>摇一摇名单</a></div>
			<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('bahe_phb', array('id' => $id))}"><i class="fa fa-users"></i>拔河名单</a></div>
			<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('bahe_setting', array('id' => $id))}"><i class="fa fa-plus"></i>拔河配置</a></div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('blacklist', array('id' => $id))}"><i class="fa fa-users"></i>粉丝黑名单</a></div>
		<div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('modules_manage', array('id' => $id))}"><i class="fa fa-list"></i>插件列表</a></div>
			<div class="btn-group">
			<a type="button" class="btn {if empty($check['id']) && $op == 'list' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}"  href="{php echo $this->createWebUrl('signcheck',array('id'=>$id))}"><i class="fa fa-toggle-off"></i>验证管理</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn  {if empty($check['id']) && $op=='post' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('signcheck',array('id'=>$id,'op' =>'post'))}"><i class="fa fa-toggle-off"></i>添加验证</a>
	</div>
	
	{if !empty($check['id']) && $op == 'post' && $_GPC['do']=='signcheck'}
	<div class="btn-group">
			<a type="button" class="btn {if !empty($check['id']) && $op == 'post' && $_GPC['do']=='signcheck'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('signcheck',array('id'=>$id,'op' =>'post'))}"><i class="fa fa-toggle-off"></i>编辑验证</a>
	</div>
	{/if}
	<div class="btn-group">
			<a type="button" class="btn {if $op == 'list' && $_GPC['do']=='mobileupload'}btn-success{else}btn-default{/if}"  href="{php echo $this->createWebUrl('mobileupload',array('id'=>$id))}"><i class="fa fa-toggle-off"></i>导入列表</a>
	</div>
	<div class="btn-group">
			<a type="button" class="btn {if $op == 'post' && $_GPC['do']=='mobileupload'}btn-success{else}btn-default{/if}" href="{php echo $this->createWebUrl('mobileupload',array('id' => $id,'op'=>'post'))}"></i>导入文件</a>
   </div>
   <div class="btn-group">
			<a type="button" class="btn btn-default" href="{php echo $this->createWebUrl('howuse',array('id' => $id))}"></i>使用说明书</a>
   </div>
	</div>
</div>
{if $operation == 'display'}
<div class="main panel panel-danger">
<div class="panel-heading ">
  
  <font color=red>排序指的是 此奖项在抽奖选项列表里的排列位置</font>
</div>
	<div class="panel-body table-responsive">
		<table class="table table-hover">
			<thead class="navbar-inner">
				<tr>
					<th>排序</th>
					<th>所属活动名称</th>
					<th>奖项</th>
					<th>奖品名称</th>					
					<th>奖品数量</th>
					<th>中奖人数</th>
					<th>准许重复中奖</th>
					<th>内定粉丝ID</th>
					<th>操作</th>
				</tr>
			</thead>
			<tbody>
				{loop $list $cj}
				<tr>
				    <td><span class="label label-danger">{$cj['displayid']}</span></td>
					<td><span class="label label-success">{$cj['huodongname']}</span></td>
					<td><span class="label label-info">{$cj['tag_name']}</span></td>
					<td><span class="label label-warning">{$cj['luck_name']}</span></td>
					<td><span class="label label-danger">{$cj['tagNum']}</span></td>
					<td><span class="label label-danger">{$cj['num']}</span></td>
					<td><span class="label label-danger">{if $cj['tag_exclude'] == '1'}否{else}是{/if}</span></td>
					<th><span class="label label-danger">{if empty($cj['nd'])}无{else}{$cj['nd']}{/if}</span></th>
					<td style="text-align:left;">
						<a href="{php echo $this->createWebUrl('awardmanage', array('id' => $id,'op' => 'post', 'cjid' => $cj['id']))}" class="btn btn-success btn-sm" data-toggle="tooltip" data-placement="top" title="修改"><i class="fa fa-edit"></i></a>
						<a href="{php echo $this->createWebUrl('awardmanage', array('id' => $id,'op' => 'delete', 'cjid' => $cj['id']))}"class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="删除" onclick="return confirm('删除将无法恢复，确认吗？');return false;"><i class="fa fa-times"></i></a>
					</td>
				</tr>
				{/loop}
			</tbody>
		</table>
		{$pager}
	</div>
</div>
<script>
	require(['bootstrap'],function($){
		$('.btn').hover(function(){
			$(this).tooltip('show');
		},function(){
			$(this).tooltip('hide');
		});
	});
</script>
{elseif $operation == 'post'}

<div class="main">
	<form action="" method="post" class="form-horizontal form" enctype="multipart/form-data" onsubmit='return formcheck()'>
		<input type="hidden" name="cjid" value="{$cj['id']}" />
		<div class="panel panel-danger">
			<div class="panel-heading">
			
			<strong>特别注意: </strong><br>
			1  添加奖品前 请先到 <strong>规则列表内</strong>  添加相应的活动规则名称、关键词等 <br> <br>
            2  添加完奖品信息后 点击编辑方可内定中奖粉丝！！<br> <br>
			3  对于内定  最好是在抽奖前 到审核内容的人员列表内 将粉丝ID填写到内定处 <br><br>
			4  若是 该奖项内定人数 > 1 请将ID 以英文逗号隔开来 且之间不能有空格<br><br>
			5  每个粉丝ID 只能内定到一个奖项 也就是说 每个粉丝最多能内定一个奖项 <br><br>
			6  内定只支持按奖项抽奖<br><br>
            7  内定抽奖不是光彩的事  酌情使用

			</div>
			<div class="panel-body">
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">奖项排序</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='displayid' name="displayid" class="form-control" value="{$cj['displayid']}" placeholder="奖项排序"/>
						<span class="help-block">此奖项在抽奖选项列表里的排列位置</span>
					</div>
				</div>
			   <div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">奖项</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='tagname' name="tag_name" class="form-control" value="{$cj['tag_name']}" placeholder="请填写奖项名称"/>
						<span class="help-block">如一等奖,二等奖等</span>
					</div>
				</div>
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">奖品名称</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='luck_name' name="luck_name" class="form-control" value="{$cj['luck_name']}" placeholder="请填写奖品名称" />
						<span class="help-block">名称尽量简明扼要</span>
					</div>
				</div>
				
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">奖品总数</span></label>
					<div class="col-sm-9 col-xs-12">
						<input type="text" id='tagNum' name="tagNum" class="form-control" value="{$cj['tagNum']}" placeholder="请填写奖品总数 需为整数"/>
						<span class="help-block">请填写整数</span>
					</div>
				</div>
				<div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span style="color:red">*</span><span class="label label-success">是否准许此奖项重复中奖</span></label>
					<div class="col-sm-9 col-xs-12">
						<label class='radio-inline'>
							<input type='radio' name='tag_exclude' value=1' {if $cj['tag_exclude']=='1'}checked{/if} /> 否
						</label>
						<label class='radio-inline'>
							<input type='radio' name='tag_exclude' value=0' {if $cj['tag_exclude']=='0'}checked{/if} /> 是
						</label>
						<span class="help-block">是否准许此奖项重复中奖</span>
					</div>
				</div>
				{if $cjid}
                <div class="form-group">
					<label class="col-xs-12 col-sm-3 col-md-2 control-label"><span class="label label-danger">内定中奖粉丝ID</span></label>
					<div class="col-sm-9 col-xs-12 col-md-6">
						<input type="text" id='nd' name="nd" class="form-control" value="{$cj['nd']}" /><br>
						<a href="{php echo $this->createWebUrl('awardmanage', array('id' => $id,'cjid'=>$cj['id'], 'op'=>'delnd'))}" class="btn btn-primary btn-sm active" role="button">如需修改内定ID 请先点击</a>
						<span class="help-block"><strong>添加活动中未签到粉丝 该奖项内定将失效</strong>  请到审核内容里将内定者ID填写到此处 依次以英文逗号隔开 如21,22,23,28</span>
					</div>
				</div>
				{/if}
			</div>
		</div>
<div class="form-group col-sm-12">
	<input type="submit" name="submit" value="提交" class="btn btn-primary col-lg-1" />
	<input type="hidden" name="token" value="{$_W['token']}" />
	</div>
	</form>
</div>

<script language='javascript'>
	function formcheck() {
		if ($("#tagname").val()=='') {
			alert("请填写奖项!");
			return false;
		}
		if ($("#luck_name").val()=='') {
			alert("请填写奖品名称!");
			return false;
		}
		if ($("#tagNum").val()=='') {
			alert("请填写奖品数量!");
			return false;
		}
		return true;
	}
</script>
{/if}
{template 'common/footer'}

