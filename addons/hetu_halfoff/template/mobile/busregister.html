{template 'header'}

<html>
	<link rel="stylesheet" type="text/css" href="{php echo HT}css/Entercss.css" />
	<link rel="stylesheet" type="text/css" href="{php echo HT}css/layer.css" />
	<script type="text/javascript" src="js/jquery-1.8.2.min.js" ></script>
	<script type="text/javascript" src="js/layer.js" ></script>
	
	<body >
          {template 'guanzhu'}
		<header>
			<h1>商家入驻</h1>
		</header>
		<form action="{php echo $this->createMobileUrl('halfbusregister', array('op'=>'register'));}" method="post" id="MainContent" name="MainContent" enctype="multipart/form-data" onsubmit="return formcheck();">
			<ul>
				<li>
					<label>店铺名称：</label>
					<input type="text" name="name" id="name" value=""  onblur="getname();"/>
				</li>
                <li>
					<label>登陆密码：</label>
					<input type="password" name="password" id="password" value="" />
				</li>
				<li>
					<label>联系人姓名：</label>
					<input type="text" name="contactman" id="contactman" value="" />
				</li>
				<li>
					<label>联系电话：</label>
					<input type="tel" name="phone" id="phone" value="" />
				</li>
				<li>
					<label>详细地址：</label>
					<input type="text" name="address" id="address" value="" /> 
				</li>
				<li>
					<label>商户照片：</label>
					<input type="file" name="img" id="img" value="" /> 
				</li>
				{if $confing['uploadcert'] == 1}
				<li>
					<label>营业执照：</label>
					<input type="file" name="license" id="license" value="" /> 
				</li>
				{/if}
			</ul>
			<div class="LoginButton" >
				<input type="submit" id="SubApply" style="font:normal 14px 'Microsoft Yahei';margin:0;padding:0;background:#009900;color:#ffffff;text-align:center;border:0;border-radius:10px;padding:3%;width:100%;font-size:16px"/>
			</div>
		</form>
		<div class="add-height"></div>
        <div style="height: 20px;"></div>
		{template 'banquan'}
	</body>

{template 'footer'}

<script>
function getname(){
        var name = $('input[name=name]').val();
        if (name == '') {
    		layer.open({
    			content: '请填写店铺名',
    			style: 'background-color:#E34F63; color:#fff; border:none;',
    			time: 1,
    			shade:false
    		});
        }
        var data ={'name':name}
        $.ajax({
		cache: false,
		url: "{php echo $this->createMobileUrl('Halfbus',array('op'=>'busname'))}",
		type: 'POST',
		data: data,
		dataType: "JSON",
		success: function(res){	
		 
			if (res > 0) {
				layer.open({
        			content: '该店铺名称已存在',
        			style: 'background-color:#E34F63; color:#fff; border:none;',
        			time: 1,
        			shade:false
        		});
              	$('input[name=name]').focus();
			}
		},
	}); 
         
           
}
function formcheck(){
	var name = $('input[name=name]').val();
    var password = $('input[name=password]').val();
	var contactman = $('input[name=contactman]').val();
	var phone = $('input[name=phone]').val();
	var cert = $('input[name=cert]').val();
	var address = $('input[name=address]').val();
	if (name == '' || name == null) {
		layer.open({
			content: '请填写店铺名',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=name]').focus();
		return false;
	}
    if (password == '' || password == null) {
		layer.open({
			content: '请填写登陆密码',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=password]').focus();
		return false;
	}
    if (password.length < 6) {
		layer.open({
			content: '登陆密码不能小于六位',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=password]').focus();
		return false;
	}
	if (contactman == '' || contactman == null) {
		layer.open({
			content: '请填写联系人',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=contactman]').focus();
		return false;
	}
	if (phone == '' || phone == null) {
		layer.open({
			content: '请填写联系电话',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=phone]').focus();
		return false;
	}
	if (address == '' || address == null) {
		layer.open({
			content: '请填写详细地址',
			style: 'background-color:#E34F63; color:#fff; border:none;',
			time: 1,
			shade:false
		});
		$('input[name=address]').focus();
		return false;
	}
	return true;
}
</script>
<script type="text/javascript">
	var _hmt = _hmt || [];
	setTimeout(function(){
		(function() {
		var hm = document.createElement("script");
		hm.src = "http://s4.cnzz.com/stat.php?id=1256263775&web_id=1256263775";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
		})();
	},0);
</script>
</html>