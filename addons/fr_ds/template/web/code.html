{template 'common/header'}
<div class="main">
    <p class="bg-warning" style="padding: 15px; color: red;">API只能在同一域名下使用</p>
    <div class="panel panel-default">
        <div class="panel-heading">
            获取代码
        </div>
        <div class="panel-body">
            <form class="form-horizontal">
                <div class="col-xs-4">
                    <div class="col-xs-12 form-group">
                        <label for="fr_sign">签名</label>
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="填写签名" id="fr_sign">
                            <div class="input-group-addon" onclick="FrSignGen();" style="cursor:pointer">生成签名</div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="col-xs-12 form-group">
                        <label for="fr_module_name">模块标识</label>
                        <input type="text" class="form-control" id="fr_module_name" placeholder="填写模块标识,例如：fr_ds">
                    </div>
                </div>
                <div class="col-xs-4">

                    <div class="col-xs-12 form-group">
                        <label for="fr_title">文章名</label>
                        <input type="text" class="form-control" placeholder="填写文章名" id="fr_title">
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="col-xs-12 form-group">
                        <label for="fr_sub_title">二级标题</label>
                        <input type="text" class="form-control" placeholder="填写二级标题" id="fr_sub_title">
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="col-xs-12 form-group">
                        <label for="fr_author">作者</label>
                        <input type="text" class="form-control" placeholder="填写作者" id="fr_author">
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="col-xs-12 form-group">
                        <label for="fr_avatar">作者头像</label>
                        <div class="input-group">
                                <input type="text" value="" placeholder="填写作者头像" id="fr_avatar" class="form-control" autocomplete="off">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" onclick="showImageDialog(this);">选择图片</button>
                                </span>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" id="CodeGenBtn">生成代码</button>
            </form>
            <pre id="CodeArea" style="margin-top: 25px; display: none;"></pre>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            接口参数说明
        </div>
        <div class="panel-body">
            <table class="table table-bordered">
                <tr>
                    <td style="width: 100px;">参数名</td>
                    <td style="width: 150px;">变量名</td>
                    <td style="width: 80px;">是否必须</td>
                    <td>备注</td>
                </tr>
                <tr>
                    <td>签名</td>
                    <td>sign</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>区分每篇文章用，防止重复请生成唯一码</td>
                </tr>
                <tr>
                    <td>模块标识</td>
                    <td>module_name</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>调用API的模块标识</td>
                </tr>
                <tr>
                    <td>文章名</td>
                    <td>title</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>
                        <ul>
                            <li>1.可在引用API页面设置<code>&lt;frtitle&gt;我是标题&lt;/frtitle&gt;</code></li>
                            <li>2.URL传参数</li>
                            <li>上面两种方法必选一</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>二级标题</td>
                    <td>sub_title</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>
                        <ul>
                            <li>1.可在引用API页面设置<code>&lt;frsubtitle&gt;二级标题&lt;/frsubtitle&gt;</code></li>
                            <li>2.URL传参数</li>
                            <li>上面两种方法必选一</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>作者</td>
                    <td>author</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>
                        <ul>
                            <li>1.可在引用API页面设置<code>&lt;frauthor&gt;作者&lt;/frauthor&gt;</code></li>
                            <li>2.URL传参数</li>
                            <li>上面两种方法必选一</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>作者头像</td>
                    <td>avatar</td>
                    <td><i class="fa fa-check text-success"></i></td>
                    <td>
                        <ul>
                            <li>1.可在引用API页面设置<code>&lt;fravatar&gt;作者头像url链接&lt;/fravatar&gt;</code></li>
                            <li>2.URL传参数</li>
                            <li>上面两种方法必选一</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>皮肤</td>
                    <td>skin</td>
                    <td><i class="fa fa-remove text-danger"></i></td>
                    <td>默认：default，可选（default）</td>
                </tr>
                <tr>
                    <td>动作</td>
                    <td>act</td>
                    <td><i class="fa fa-remove text-danger"></i></td>
                    <td>当act等于<code>check</code>时，检查当前用户是否已经成功赞赏过，是返回<code>yes</code>，否返回<code>no</code></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            示例
        </div>
        <div class="panel-body">
            <pre>
    &lt;p style="display:none;"&gt;
        &lt;frtitle&gt;通用赞赏测试&lt;/frtitle&gt;
        &lt;frsubtitle&gt;亲！赞赏一个嘛&lt;/frsubtitle&gt;
        &lt;frauthor&gt;微赞&lt;/frauthor&gt;
        &lt;fravatar&gt;{__IMG__}/100.gif&lt;/fravatar&gt;
    &lt;/p&gt;
    &LT;script src="{$script_url}&sign=sign123456789&module_name=fr_ds"&gt;&lt;/script&gt;
            </pre>
        </div>
    </div>
</div>
<script type="text/template" id="codeTemplate">
&lt;p style="display:none;"&gt;
    &lt;frtitle&gt;#frtitle#&lt;/frtitle&gt;
    &lt;frsubtitle&gt;#frsubtitle#&lt;/frsubtitle&gt;
    &lt;frauthor&gt;#frauthor#&lt;/frauthor&gt;
    &lt;fravatar&gt;#fravatar#&lt;/fravatar&gt;
&lt;/p&gt;
&LT;script src="{$script_url}&sign=#sign#&module_name=#module_name#"&gt;&lt;/script&gt;
</script>
<script>
    function FrSignGen() {
        var letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        var token = '';
        for (var i = 0; i < 32; i++) {
            var j = parseInt(Math.random() * 61 + 1);
            token += letters[j];
        }
        $('#fr_sign').val(token);
    }
    $("#CodeGenBtn").click(function(){
        var fr_sign = $("#fr_sign").val(), fr_module_name = $("#fr_module_name").val(), 
            fr_title = $("#fr_title").val(), fr_sub_title = $("#fr_sub_title").val(), 
            fr_author = $("#fr_author").val(), fr_avatar = $("#fr_avatar").val();
            if (fr_sign == '') {
                alert('请填写签名');
                return false;
            }
            if (fr_module_name == '') {
                alert('请填写模块标识');
                return false;
            }
            if (fr_title == '') {
                alert('请填写文章名');
                return false;
            }
            if (fr_sub_title == '') {
                alert('请填写二级标题');
                return false;
            }
            if (fr_author == '') {
                alert('请填写作者');
                return false;
            }
            if (fr_avatar == '') {
                alert('请填写作者头像');
                return false;
            }
            var tepmlate = $("#codeTemplate").html().replace(/#frtitle#/, fr_title).replace(/#frsubtitle#/, fr_sub_title).replace(/#frauthor#/, fr_author)
            .replace(/#fravatar#/, fr_avatar).replace(/#sign#/, fr_sign).replace(/#module_name#/, fr_module_name);
            $("#CodeArea").html(tepmlate).show();
    });
    function showImageDialog(elm) {
            require(["util"], function(util){
                    var btn = $(elm);
                    var ipt = btn.parent().prev();
                    var val = ipt.val();
                    var options = {
                        global:false,
                        direct:true,
                        multiple:false,
                    };
                    util.image(val, function(url){
                        if(url.url){
                            ipt.val(url.url);
                        }
                    }, null, options);
            });
    }
</script>
{template 'common/footer'}