!function(a,b){a.Logger.Console=b()}(this,function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=window.Logger.data.CONSOLE_LOG_ARR.reverse(),o=10,p=function(){a=document.getElementById("mqq-tools"),b=document.getElementById("tools-log-tab"),c=document.getElementById("tools-log-data"),d=document.getElementById("tools-close-btn"),e=document.getElementById("tools-tab-container"),f=document.getElementById("clear-log"),g=document.getElementById("tools-log-more"),h=document.getElementById("clearStorage"),i=document.getElementById("updateOffline"),getOffline=document.getElementById("getOffline"),m=document.getElementById("disableOffline"),j=document.getElementById("cgiDetail"),k=document.getElementById("clickReport"),l=document.getElementById("clearCgi")},q=function(a){var b=window.document.createElement("link"),c=window.document.getElementsByTagName("script")[0];return b.rel="stylesheet",b.href=a,b.media="all",c.parentNode.insertBefore(b,c),b},r=function(a){var b,c,d,e=0;for(c=0,d=a.length;d>c;c++)b=a.charCodeAt(c),e+=127>=b?1:2047>=b?2:65535>=b?3:4;return e},s=function(a,b,c){if(c)return b;for(var d="",e=0;a>e;e++)d+="  ";return d+b},t=function(a,b){var c,d="",e=Object.prototype.toString.call(a);if("[object Array]"===e)if(0===a.length)d+=s(b,"[]");else{for(d+="[\r\n",c=0;c<a.length;c++)d+=s(b+1,t(a[c],b+1)+(c==a.length-1?"":",")+"\r\n");d+=s(b,"]")}else if("[object Object]"===e){try{JSON.stringify(a)}catch(f){throw f.message}var g,h=0;for(g in a)a.hasOwnProperty(g)&&h++;if(0===h)d+=s(b,"{}");else{c=0,d+="{<span class='tree-node off'></span><span class='wrapper hidden'>\r\n";for(g in a)if(a.hasOwnProperty(g)){c++;d+=s(b+1,"<span class='key'>\""+g+'"</span>:'+t(a[g],b+1)+(c===h?"":",")+"\r\n")}d+=s(b,"</span>}")}}else if("[object Number]"===e)d+="<span class='number'>"+a+"</span>";else if("[object Boolean]"===e)d+="<span class='boolean'>"+a+"</span>";else if("[object Undefined]"===e)d+='"undefined"';else if("[object Null]"===e)d+="<span class='null'>"+a+"</span>";else if("[object String]"===e)d+="<span class='string'>\""+a.replace("\r\n","").split("<").join("&lt;").split(">").join("&gt;")+'"</span>';else if(e.match(/^\[object HTML([a-zA-Z]+)Element\]$/)&&"mqq-tools"!==a.id){for(var i,j=a.attributes,k="",c=0;c<j.length;c++)k+="<span class='attr-name'>"+j[c].nodeName+"</span><span class='tag-name'>=\"</span><span class='attr-value'>"+j[c].nodeValue+"</span><span class='tag-name'>\"</span>";i=a.childElementCount||"script"===a.nodeName.toLowerCase()&&!a.src,d+=i?"<span class='html-node'></span>":"",d+="<span class='tag-name'>&lt;"+a.nodeName.toLowerCase()+"</span> "+k+"<span class='tag-name'>&gt;</span>"+(a.childElementCount,""),d+=i?"<span class='quot'>...</span><span class='wrapper hidden'>":"";for(var l=a.children,m=0;m<l.length;m++)d+=i?"\r\n":"",d+=s(b+1,t(l[m],b+1));d+=a.childElementCount?"":a.textContent.split("<").join("&lt;").split(">").join("&gt;"),d+=i?"\r\n":"",d+=i?s(b,"</span><span class='tag-name'>&lt;/"+a.nodeName.toLowerCase()+"&gt;</span>"):"<span class='tag-name'>&lt;/"+a.nodeName.toLowerCase()+"&gt;</span>"}else d+="<span class='string'>"+e+"</span>";return d},u=function(a,b){var c=document.createElement("a");return c.href=a,c[b]},v=function(a,b){a=new Date(a),b="MM-dd h:mm:ss.S";var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"S+":a.getMilliseconds()};for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1===RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},w=function(a,b){for(var d,e,f=a.content,g=[],h=0;h<f.length;h++){e=f[h];try{g[h]=t(e,0)}catch(i){a.level="ERROR",g[h]=i}}d="<div class='log-content one-line more-content'>"+g.join("|")+"</div>",b?c.innerHTML="<div class='log-line "+a.level+"'><p class='log-toptext'><span>"+v(a.time)+"</span><span class='log-copy'></span></p>"+d+"</div>"+c.innerHTML:c.innerHTML+="<div class='log-line "+a.level+"'><p class='log-toptext'><span>"+v(a.time)+"</span><span class='log-copy'></span></p>"+d+"</div>"},x=function(a){for(var b=window.Logger.data.cgiArr,c=document.getElementById("cgiTable"),d=a;d<b.length;d++){var e=document.createElement("tr");e.classList.add("cgi-tr"),e.setAttribute("index",d);var f=document.createElement("td"),g=document.createElement("td"),h=document.createElement("td");f.textContent=u(b[d].url,"pathname"),g.textContent=b[d].time+"ms",h.textContent=r(b[d].text)+"b",e.appendChild(f),e.appendChild(g),e.appendChild(h),c.appendChild(e)}},y=function(){var a=function(){for(var a="<label>cookie信息</label><div class='info'><table class='cookie-table'>$$!!cookie</table></div>",b=document.cookie.split(";"),c=document.createElement("table"),d=0;d<b.length;d++){var e=document.createElement("tr"),f=document.createElement("td"),g=document.createElement("td");f.textContent=b[d].split("=")[0],g.textContent=b[d].split("=")[1],e.appendChild(f),e.appendChild(g),c.appendChild(e)}return a.replace("$$!!cookie",c.innerHTML)},b=function(){var a="<label>codeEx</label><div class='info'>$$!!codeEx</div>",b=document.createElement("div"),c=document.createElement("ul");c.id="codeExUl";var d=document.createElement("input"),e=document.createElement("div");return e.innerHTML="Submit",e.classList.add("eval-btn"),e.classList.add("other-btn"),d.type="email",d.id="evalInput",b.appendChild(c),b.appendChild(d),b.appendChild(e),a.replace("$$!!codeEx",b.innerHTML)},c=function(){var a="<label>当前网页链接</label><p class='info'>"+window.location.href+"</p>";return a},d=function(){for(var a="<label>cgi<span class='clear-cgi' id='clearCgi'></span></label><div id='cgiInfo' class='info'><table id='cgiTable' class='cgi-table'>$$!!cgi</table><div class='hidden log-cgi-detail' id='cgiDetail'></div></div>",b=window.Logger.data.cgiArr,c=document.createElement("table"),d=0;d<b.length;d++){var e=document.createElement("tr");e.classList.add("cgi-tr"),e.setAttribute("index",d);var f=document.createElement("td"),g=document.createElement("td"),h=document.createElement("td");f.textContent=u(b[d].url,"pathname"),g.textContent=b[d].time+"ms",h.textContent=r(b[d].text)+"b",e.appendChild(f),e.appendChild(g),e.appendChild(h),c.appendChild(e)}return a.replace("$$!!cgi",c.innerHTML)},e=function(){var a="<label>资源耗时</label><div id='resourceInfo' class='info'><table id='resourceTable' class='info-table'>$$!!resource</table></div>",b=document.createElement("table");if(window.performance&&window.performance.getEntries)for(var c,d=/([^\/]+\.(js|css))/,e=window.performance.getEntries(),f=0;f<e.length;f++)if(c=e[f],"link"===c.initiatorType||"script"===c.initiatorType){var g=document.createElement("tr");g.classList.add("resource-tr"),g.setAttribute("index",f);var h=document.createElement("td"),i=document.createElement("td");h.textContent=d.exec(c.name)?d.exec(c.name)[0]:"",i.textContent=parseInt(c.duration)+"ms",g.appendChild(h),g.appendChild(i),b.appendChild(g)}return a.replace("$$!!resource",b.innerHTML)},f=function(){var a=t(document.getElementsByTagName("html")[0],0),b="<label>HTML结构</label><div id='htmlInfo' class='info'><pre style='word-wrap: break-word;'>"+a+"</pre></div>";return b},g=function(){var a="<label>LocalStorage</label><div id='lsInfo' class='info'><div id='lsTable' class='info-table'>$$!!ls</div></div>",b=document.createElement("div");for(var c in window.localStorage){var d=window.localStorage.getItem(c);if("string"==typeof d&&d.length<50){var e=document.createElement("div");e.classList.add("ls-tr");var f=document.createElement("div"),g=document.createElement("div");f.classList.add("ls-td"),f.classList.add("ls-td-key"),g.classList.add("ls-td"),g.classList.add("ls-td-data"),f.innerHTML='<span style="color:#2E507F;">('+(Number(r(d))/1024/1024).toFixed(2)+"MB) </span>"+c;try{d=JSON.parse(d)}catch(h){g.classList.add("ls-td-string"),d=d}g.innerHTML="<pre>"+t(d,0)+"</pre>",e.appendChild(f),e.appendChild(g),b.appendChild(e)}}return a.replace("$$!!ls",b.innerHTML)},h=function(){var a="<label>环境信息</label><p class='info'>$$!!env</p>",b={os:$.os.android?"android":"ios",os_ver:$.os.version,offline:Config&&Config.isOffline};return mqq.QQVersion&&(b.qqv=mqq.QQVersion),a.replace("$$!!env",JSON.stringify(b))},i=function(){for(var a="",b=window.Logger.data.LoggerOption.myWidget,c=0;c<b.length;c++)a+=b[c].getHtml()||"";return a},j=function(){for(var a="<div class='other-btn' id='clickReport'>一键上报</div>",b="<div class='other-btn' id='clearStorage'>清除localstorage</div>",c="<div class='other-btn' id='updateOffline'>更新离线包版本</div>",d="<div class='other-btn' id='getOffline'>离线包版本</div>",e="<div class='other-btn' id='disableOffline'>暂时禁用离线包</div>",f="",g=window.Logger.data.LoggerOption.myButton,h=0;h<g.length;h++)f+=g[h].getHtml()||"";return a+b+d+c+e+f},k="<div class='hidden slideDown' id='mqq-tools'><a id='tools-close-btn'></a><ul id='tools-head'><li id='tools-log-li' class='active-log'>日志</li><li id='tools-func-li'>常用功能</li></ul><div id='tools-tab-container'><div id='tools-log-tab' class='tools-tab active-log'><div id='tools-log-data'></div><div id='tools-log-more' page='1'>查看更多</div></div><div id='tools-func-tab' class='tools-tab'><div id='funcWrap' class='func-wrap'>$$!!widget<label>其他功能</label><div class='info'>$$!!other</div></div></div></div></div>",l=function(){for(var j=window.Logger.data.LoggerOption.widgetList,k={location:c,env:h,cookie:a,cgi:d,codeEx:b,resource:e,dom:f,localStorage:g},l="",m=0;m<j.length;m++)k[j[m]]&&(l+=k[j[m]]());return l+i()};k=k.replace("$$!!widget",function(){return l()}).replace("$$!!other",j());var m=document.createElement("div");m.innerHTML=k,document.body.appendChild(m)},z=function(){for(var b=function(a){var b,c=a.target,d=c.id.replace("-li","-tab"),e=document.querySelectorAll(".active-log");for(b=e.length;b--;)e[b].classList.remove("active-log");document.querySelector("#"+d).classList.add("active-log"),c.classList.add("active-log")},c=document.querySelectorAll("#tools-head li"),e=c.length;e--;)c[e].addEventListener("click",b,!1);a.addEventListener("touchmove",function(a){return a.stopPropagation(),!1}),d.addEventListener("touchstart",function(){a.classList.toggle("hide-log"),d.classList.toggle("extend")},!1),a.addEventListener("touchstart",function(a){var b=a.touches[0].target;if(b.classList.contains("tree-node")||b.classList.contains("html-node"))b.classList.toggle("off"),b.nextElementSibling.classList.contains("wrapper")?b.nextElementSibling.classList.toggle("hidden"):(!function(a){var b={nextAll:function(b){for(var c=a(),d=this.next();d.length;)("undefined"==typeof b||d.is(b))&&(c=c.add(d)),d=d.next();return c},prevAll:function(b){for(var c=a(),d=this.prev();d.length;)("undefined"==typeof b||d.is(b))&&(c=c.add(d)),d=d.prev();return c}};a.extend(a.fn,b)}(Zepto),$(b).nextAll(".quot").toggleClass("hidden"),$(b).nextAll(".wrapper").toggleClass("hidden"));else if(b.classList.contains("log-copy")){var c=b.parentElement.nextElementSibling.textContent;mqq.data.setClipboard({text:c},function(a){a&&Tip.show("已复制到剪切板")})}else b.parentElement.classList.contains("cgi-tr")?b.parentElement.classList.contains("cgi-tr")&&B(b):b.classList.contains("close-detail")?j.classList.add("hidden"):b.classList.contains("eval-btn")&&A()}),g.addEventListener("touchstart",function(a){for(var b=parseInt(a.target.getAttribute("page")),c=Math.max(0,n.length-o*b),d=o>c?c:o,e=0;d>e;e++)w(n[e+o*b]);a.target.setAttribute("page",b+1),o>c&&(a.target.innerHTML="没有更多")}),l.addEventListener("touchstart",function(){window.Logger.data.cgiArr=[],document.getElementById("cgiTable").innerHTML=""}),h.addEventListener("touchstart",function(){window.localStorage.clear(),alert("localStorage清除成功。")}),i.addEventListener("touchstart",function(){mqq.offline.checkUpdate({bid:128},function(a){a.url?mqq.offline.downloadUpdate({bid:128,url:a.url},function(b){0===b.ret?Tip.show("更新成功"+a.version):Tip.show("更新失败")}):Tip.show("已经是最新")})}),getOffline.addEventListener("touchstart",function(){mqq.offline.isCached({bid:128},function(a){Tip.show("版本号："+a)})}),k.addEventListener("touchstart",function(){for(var a=window.Logger.data.CONSOLE_LOG_ARR,b=Date.now(),c=[],d=0;d<a.length;d++)b-a[d].time<3e5&&c.push(a[d]);window.Logger.Ajax.request("http://buluo.qq.com/cgi-bin/feedback/re/creport",{method:"POST",data:JSON.stringify(c),success:function(a){var b=JSON.parse(a.responseText);0==b?(window.Logger.checkWrightList(),alert("上报成功")):alert("上报失败")},failure:function(){alert("上报失败")}})}),m.addEventListener("touchstart",function(){mqq.offline.disableCache(function(a){console.log(a),"OK"==a.msg&&Tip.show("禁用成功")})}),window.Logger.data.LoggerOption.myEvent()},A=function(){var a=document.getElementById("evalInput"),b=document.createElement("li");b.classList.add("eval-li");var c,d="<p class='exec'>>>>  "+a.value+"</p>",e="";try{c=window.eval(a.value)}catch(f){e="error",c=f.message}var g="<pre class='exec-content "+e+"'>"+t(c,0)+"</pre>";b.innerHTML=d+g,document.getElementById("codeExUl").appendChild(b)},B=function(a){for(var b=a.parentElement,c=document.getElementsByClassName("cgi-tr"),d=c.length-1;d>=0;d--)c[d].classList.remove("active-cgi");b.classList.add("active-cgi");var e=b.getAttribute("index"),f=document.getElementById("cgiDetail"),g="<h1 class='title'>详细信息</h1>",h="<h3>ResponseHeaders:</h3><pre class='detail-data'>"+window.Logger.data.cgiArr[e].headers+"</pre>",i="<h3>RequestUrl:</h3><pre class='detail-data'>"+u(window.Logger.data.cgiArr[e].url,"pathname")+"</pre>",j="<h3>Code:</h3><pre class='detail-data'>"+window.Logger.data.cgiArr[e].status+"</pre>",k=window.Logger.data.cgiArr[e].params,l=function(a){for(var b={},c=0;c<a.length;c++)b[a[c].split("=")[0]]=a[c].split("=")[1];return b};c=k.lastIndexOf("http://")>-1?u(k,"search").split("&"):k.split("&");var m;try{m=JSON.parse(window.Logger.data.cgiArr[e].text)}catch(n){m=window.Logger.data.cgiArr[e].text}var o="<h3>Params:</h3><pre class='detail-data'>"+JSON.stringify(l(c),null,2)+"</pre>",p="<h3>Response:</h3><pre class='detail-data'>"+t(m,0)+"</pre>";f.innerHTML=g+h+i+j+o+p,f.classList.remove("hidden")},C=!0,D=0,E=function(){try{if(+new Date-D<5e3)return;if(C){q(window.Logger.data.LOG_CSS_URL),y(),p();try{}catch(b){}window.Logger.data.IS_CONSOLE_OPEN=!0;for(var c=Math.min(o,n.length),d=0;c>d;d++)w(n[d]);z(),C=!1,F()}else window.Logger.data.IS_CONSOLE_OPEN?a.style.display="none":a.style.display="block",window.Logger.data.IS_CONSOLE_OPEN=!window.Logger.data.IS_CONSOLE_OPEN;D=+new Date,document.getElementById("log-preload").style.display="none",a.classList.remove("hidden")}catch(b){throw alert(b),b}},F=function(){var a,b=navigator.userAgent;a=/Android/i.test(b)?/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/.test(b)?504987:504998:/iPhone|iPod|iPad/i.test(b)?/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/.test(b)?504986:504997:504999;var c=new Image;c.src="http://cgi.pub.qq.com/report/report_vm?monitors=["+a+"]&t="+Date.now(),c=null};return{createLog:E,renderLog:w,renderCgi:x}});